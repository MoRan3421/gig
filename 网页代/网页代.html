<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NovaServe æ˜ŸåŸŸè‡ªç”±èŒä¸šå¹³å° | MY</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;1,9..40,400&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#06061a;--bg2:#0b0b22;--surface:rgba(255,255,255,.055);--surface2:rgba(255,255,255,.09);--surface3:rgba(255,255,255,.13);
  --border:rgba(255,255,255,.09);--border2:rgba(255,255,255,.17);--border3:rgba(255,255,255,.25);
  --accent:#6effd4;--accent2:#a78bfa;--accent3:#f472b6;--accent4:#38bdf8;
  --gold:#fbbf24;--success:#4ade80;--danger:#f87171;--warn:#fb923c;
  --text:#eeeeff;--muted:#7878a0;--muted2:#5a5a80;
  --r:16px;--r-sm:10px;--r-xs:7px;
  --shadow:0 24px 64px rgba(0,0,0,.7);
  --glow-accent:0 0 30px rgba(110,255,212,.15);
  --font-display:'Syne',sans-serif;
  --font-body:'DM Sans',sans-serif;
  --font-mono:'JetBrains Mono',monospace;
}
*{box-sizing:border-box;margin:0;padding:0;-webkit-font-smoothing:antialiased}
html{scroll-behavior:smooth}
body{font-family:var(--font-body);background:var(--bg);color:var(--text);min-height:100vh;overflow-x:hidden}

/* BG */
body::before{content:'';position:fixed;inset:0;
  background:
    radial-gradient(ellipse 100% 60% at 10% -5%,rgba(110,255,212,.07),transparent 60%),
    radial-gradient(ellipse 70% 50% at 90% 110%,rgba(167,139,250,.07),transparent 60%),
    radial-gradient(ellipse 50% 40% at 50% 50%,rgba(56,189,248,.03),transparent);
  pointer-events:none;z-index:0}
.stars-bg{position:fixed;inset:0;z-index:0;pointer-events:none;overflow:hidden}
.star{position:absolute;border-radius:50%;background:#fff;animation:twinkle var(--dur,3s) var(--delay,0s) infinite}
@keyframes twinkle{0%,100%{opacity:.1}50%{opacity:.6}}

/* HEADER */
header{position:sticky;top:0;z-index:200;display:flex;align-items:center;justify-content:space-between;padding:0 32px;height:68px;
  background:rgba(6,6,26,.88);backdrop-filter:blur(24px);border-bottom:1px solid var(--border)}
.logo{display:flex;align-items:center;gap:11px;text-decoration:none;color:inherit;cursor:pointer}
.logo-icon{width:42px;height:42px;border-radius:11px;background:linear-gradient(135deg,var(--accent),var(--accent2));
  display:flex;align-items:center;justify-content:center;font-family:var(--font-display);font-weight:800;font-size:17px;color:#000;
  box-shadow:0 0 22px rgba(110,255,212,.25)}
.logo-text{font-family:var(--font-display);font-weight:700;font-size:1.05rem}
.logo-sub{font-size:.68rem;color:var(--muted);display:block;margin-top:-2px}
.hdr-search{flex:1;max-width:480px;margin:0 32px;display:flex;background:var(--surface2);border:1px solid var(--border2);border-radius:999px;overflow:hidden}
.hdr-search input{flex:1;padding:9px 18px;background:none;border:none;color:var(--text);font-family:var(--font-body);font-size:.88rem;outline:none}
.hdr-search input::placeholder{color:var(--muted)}
.hdr-search-btn{padding:9px 20px;background:linear-gradient(135deg,var(--accent),var(--accent2));border:none;color:#000;font-weight:700;cursor:pointer;font-size:.82rem;white-space:nowrap;transition:.2s}
.hdr-search-btn:hover{opacity:.85}
.hdr-nav{display:flex;align-items:center;gap:2px;margin-right:12px}
.hdr-nav a{padding:7px 13px;border-radius:9px;color:var(--muted);text-decoration:none;font-size:.84rem;transition:.2s;cursor:pointer;white-space:nowrap}
.hdr-nav a:hover,.hdr-nav a.active{color:var(--text);background:var(--surface2)}
.hdr-actions{display:flex;align-items:center;gap:7px}
.btn-hdr{padding:8px 17px;border-radius:9px;font-size:.83rem;font-family:var(--font-body);cursor:pointer;transition:.2s}
.btn-login{background:none;border:1px solid var(--border2);color:var(--text)}
.btn-login:hover{background:var(--surface2)}
.btn-signup{background:linear-gradient(135deg,var(--accent),var(--accent2));border:none;color:#000;font-weight:700}
.btn-signup:hover{opacity:.88;transform:translateY(-1px)}
.icon-btn{width:36px;height:36px;border-radius:9px;background:var(--surface);border:1px solid var(--border);
  display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:.95rem;transition:.2s;position:relative}
.icon-btn:hover{background:var(--surface2)}
.dot-badge{width:8px;height:8px;background:var(--danger);border-radius:50%;border:2px solid var(--bg);position:absolute;top:-2px;right:-2px}
.avatar-btn{width:36px;height:36px;border-radius:50%;background:linear-gradient(135deg,var(--accent2),var(--accent3));
  border:2px solid var(--accent);cursor:pointer;display:flex;align-items:center;justify-content:center;
  font-size:.75rem;font-weight:700;color:#000;font-family:var(--font-display)}

/* LAYOUT */
main{position:relative;z-index:1}
.wrap{max-width:1280px;margin:0 auto;padding:0 32px}
.page{display:none}
.page.active{display:block}
section{margin-bottom:56px}
.sec-hd{display:flex;align-items:center;justify-content:space-between;margin-bottom:22px}
.sec-title{font-family:var(--font-display);font-weight:700;font-size:1.35rem}
.sec-link{color:var(--accent);font-size:.83rem;text-decoration:none;cursor:pointer}
.sec-link:hover{text-decoration:underline}

/* BUTTONS */
.btn{border:none;border-radius:11px;padding:11px 18px;font-family:var(--font-body);font-weight:600;cursor:pointer;transition:.2s;display:inline-flex;align-items:center;gap:6px;font-size:.88rem}
.btn-primary{background:linear-gradient(135deg,var(--accent),var(--accent2));color:#000}
.btn-primary:hover{opacity:.88;transform:translateY(-1px);box-shadow:0 8px 24px rgba(110,255,212,.2)}
.btn-secondary{background:var(--surface2);color:var(--text);border:1px solid var(--border2)}
.btn-secondary:hover{background:var(--surface3)}
.btn-danger{background:rgba(248,113,113,.15);color:var(--danger);border:1px solid rgba(248,113,113,.25)}
.btn-danger:hover{background:rgba(248,113,113,.25)}
.btn-full{width:100%;justify-content:center}
.btn-lg{padding:14px 24px;font-size:.95rem;border-radius:13px}
.btn-sm{padding:6px 13px;font-size:.78rem;border-radius:8px}

/* FORMS */
.form-group{margin-bottom:15px}
.form-label{font-size:.8rem;color:var(--muted);margin-bottom:6px;display:block;font-weight:500}
.form-label span.req{color:var(--danger)}
.form-input{width:100%;padding:11px 14px;border-radius:var(--r-sm);background:var(--surface2);border:1px solid var(--border2);
  color:var(--text);font-family:var(--font-body);font-size:.88rem;outline:none;transition:.2s}
.form-input:focus{border-color:var(--accent);box-shadow:0 0 0 3px rgba(110,255,212,.08)}
.form-input::placeholder{color:var(--muted2)}
select.form-input{cursor:pointer}
select.form-input option{background:#1a1a3d}
textarea.form-input{resize:vertical;min-height:95px;line-height:1.6}
.input-row{display:grid;gap:12px}
.input-2{grid-template-columns:1fr 1fr}
.input-3{grid-template-columns:1fr 1fr 1fr}
.input-icon-wrap{position:relative}
.input-icon-wrap .form-input{padding-left:40px}
.input-icon{position:absolute;left:12px;top:50%;transform:translateY(-50%);color:var(--muted);font-size:.9rem}

/* CARDS */
.card{background:var(--surface);border:1px solid var(--border);border-radius:var(--r);padding:22px}
.card-sm{padding:16px;border-radius:var(--r-sm)}
.card-accent{border-color:rgba(110,255,212,.2);background:rgba(110,255,212,.04)}
.card-warn{border-color:rgba(251,146,60,.2);background:rgba(251,146,60,.04)}
.card-danger{border-color:rgba(248,113,113,.2);background:rgba(248,113,113,.04)}

/* HERO */
.hero{padding:72px 32px 52px;text-align:center;max-width:1280px;margin:0 auto}
.hero-tag{display:inline-flex;align-items:center;gap:8px;padding:5px 15px;border-radius:999px;
  background:rgba(110,255,212,.08);border:1px solid rgba(110,255,212,.18);font-size:.77rem;color:var(--accent);margin-bottom:22px}
.hero h1{font-family:var(--font-display);font-weight:800;font-size:clamp(2.2rem,4.5vw,3.8rem);line-height:1.1;margin-bottom:18px}
.hero h1 .grad{background:linear-gradient(135deg,var(--accent),var(--accent2),var(--accent3));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.hero-sub{font-size:1.05rem;color:var(--muted);max-width:520px;margin:0 auto 32px;line-height:1.7}
.hero-form{display:flex;max-width:620px;margin:0 auto 44px;background:var(--surface2);border:1px solid var(--border2);border-radius:15px;overflow:hidden;box-shadow:var(--glow-accent)}
.hero-form select{padding:15px 16px;background:var(--surface);border:none;border-right:1px solid var(--border2);color:var(--text);font-family:var(--font-body);cursor:pointer;outline:none;font-size:.88rem;min-width:130px}
.hero-form select option{background:#1a1a3d}
.hero-form input{flex:1;padding:15px 18px;background:none;border:none;color:var(--text);font-family:var(--font-body);font-size:.92rem;outline:none}
.hero-form input::placeholder{color:var(--muted)}
.hero-form button{padding:15px 26px;background:linear-gradient(135deg,var(--accent),var(--accent2));border:none;color:#000;font-weight:700;cursor:pointer;font-family:var(--font-display);font-size:.88rem;transition:.2s}
.hero-form button:hover{opacity:.88}
.hero-stats{display:flex;justify-content:center;gap:40px;flex-wrap:wrap}
.h-stat-num{font-family:var(--font-display);font-weight:800;font-size:1.45rem;color:var(--accent)}
.h-stat-lbl{font-size:.77rem;color:var(--muted);margin-top:1px}

/* CAT SCROLL */
.cat-scroll{display:flex;gap:9px;overflow-x:auto;padding:0 32px 14px;scrollbar-width:none;margin-bottom:36px}
.cat-scroll::-webkit-scrollbar{display:none}
.cat-pill{display:flex;align-items:center;gap:7px;padding:9px 18px;border-radius:999px;background:var(--surface);border:1px solid var(--border);
  color:var(--muted);font-size:.83rem;cursor:pointer;white-space:nowrap;transition:.2s;user-select:none;font-weight:500}
.cat-pill:hover{color:var(--text);border-color:var(--border2)}
.cat-pill.active{background:rgba(110,255,212,.1);border-color:var(--accent);color:var(--accent)}

/* GIG GRID */
.gig-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(272px,1fr));gap:18px}
.gig-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--r);overflow:hidden;cursor:pointer;transition:.3s;position:relative}
.gig-card:hover{transform:translateY(-5px);border-color:rgba(110,255,212,.2);box-shadow:0 18px 50px rgba(0,0,0,.5),0 0 0 1px rgba(110,255,212,.08)}
.gig-thumb{height:172px;display:flex;align-items:center;justify-content:center;font-size:3.5rem;position:relative;overflow:hidden}
.gig-thumb::after{content:'';position:absolute;inset:0;background:linear-gradient(to bottom,transparent 50%,rgba(6,6,26,.85))}
.gig-badge{position:absolute;top:11px;left:11px;z-index:1;padding:4px 10px;border-radius:999px;background:rgba(6,6,26,.8);backdrop-filter:blur(8px);font-size:.68rem;border:1px solid var(--border2);color:var(--text)}
.gig-fav{position:absolute;top:11px;right:11px;z-index:1;width:29px;height:29px;border-radius:50%;background:rgba(6,6,26,.8);backdrop-filter:blur(8px);
  display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:.85rem;transition:.2s;border:1px solid var(--border)}
.gig-fav:hover{background:rgba(248,113,113,.2);border-color:var(--danger)}
.gig-fav.on{background:rgba(248,113,113,.2);border-color:var(--danger)}
.gig-body{padding:15px}
.gig-seller-row{display:flex;align-items:center;gap:7px;margin-bottom:9px}
.s-av{width:24px;height:24px;border-radius:50%;background:linear-gradient(135deg,var(--accent),var(--accent2));display:flex;align-items:center;justify-content:center;font-size:.6rem;font-weight:700;color:#000;flex-shrink:0}
.s-name{font-size:.78rem;color:var(--muted)}
.s-lvl{font-size:.62rem;padding:2px 6px;border-radius:999px;background:rgba(110,255,212,.1);color:var(--accent);border:1px solid rgba(110,255,212,.15)}
.gig-title{font-size:.88rem;font-weight:500;line-height:1.45;margin-bottom:9px;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
.gig-foot{display:flex;align-items:center;justify-content:space-between}
.g-rating{display:flex;align-items:center;gap:4px;font-size:.77rem;color:var(--gold)}
.g-price{font-family:var(--font-display);font-weight:700;font-size:.92rem;color:var(--accent)}
.g-price small{font-size:.67rem;color:var(--muted);font-family:var(--font-body);font-weight:400}

/* SELLER CARD */
.seller-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(210px,1fr));gap:14px}
.seller-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--r);padding:22px 15px;text-align:center;cursor:pointer;transition:.3s}
.seller-card:hover{transform:translateY(-4px);border-color:var(--border2);box-shadow:var(--shadow)}
.sc-av{width:66px;height:66px;border-radius:50%;margin:0 auto 11px;background:linear-gradient(135deg,var(--accent),var(--accent2));display:flex;align-items:center;justify-content:center;font-size:1.7rem;box-shadow:0 0 18px rgba(110,255,212,.18)}
.sc-name{font-family:var(--font-display);font-weight:600;margin-bottom:3px;font-size:.92rem}
.sc-title{font-size:.77rem;color:var(--muted);margin-bottom:9px}
.sc-stats{display:flex;justify-content:center;gap:14px;font-size:.72rem}
.sc-stat strong{display:block;color:var(--accent);font-family:var(--font-display);font-size:.85rem}
.badge-pro{display:inline-block;padding:3px 8px;border-radius:999px;font-size:.63rem;background:linear-gradient(135deg,var(--gold),#f97316);color:#000;font-weight:700;margin-bottom:7px}
.badge-top{display:inline-block;padding:3px 8px;border-radius:999px;font-size:.63rem;background:linear-gradient(135deg,var(--accent),var(--accent2));color:#000;font-weight:700;margin-bottom:7px}

/* MODALS */
.overlay{position:fixed;inset:0;background:rgba(0,0,0,.78);backdrop-filter:blur(10px);z-index:1000;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:.25s;padding:16px}
.overlay.show{opacity:1;pointer-events:all}
.modal{background:#0d0d26;border:1px solid var(--border2);border-radius:20px;max-width:960px;width:100%;max-height:92vh;overflow-y:auto;transform:translateY(18px) scale(.97);transition:.25s;scrollbar-width:thin;scrollbar-color:var(--border) transparent}
.overlay.show .modal{transform:none}
.modal-hd{display:flex;align-items:center;justify-content:space-between;padding:22px 26px;border-bottom:1px solid var(--border);position:sticky;top:0;background:#0d0d26;z-index:2}
.modal-hd h2{font-family:var(--font-display);font-weight:700;font-size:1.1rem}
.modal-close{width:33px;height:33px;border-radius:8px;background:var(--surface);border:1px solid var(--border);cursor:pointer;font-size:1rem;display:flex;align-items:center;justify-content:center;transition:.2s;color:var(--text)}
.modal-close:hover{background:rgba(248,113,113,.18);border-color:var(--danger);color:var(--danger)}
.modal-body{padding:26px}

/* GIG DETAIL */
.gd-grid{display:grid;grid-template-columns:1fr 320px;gap:26px}
@media(max-width:680px){.gd-grid{grid-template-columns:1fr}}
.gd-img{height:280px;border-radius:13px;display:flex;align-items:center;justify-content:center;font-size:5rem;margin-bottom:18px;border:1px solid var(--border);position:relative;overflow:hidden}
.gd-title{font-family:var(--font-display);font-weight:700;font-size:1.4rem;margin-bottom:14px;line-height:1.3}
.tag-row{display:flex;flex-wrap:wrap;gap:7px;margin-bottom:14px}
.tag{padding:4px 11px;border-radius:999px;background:var(--surface2);border:1px solid var(--border);font-size:.72rem;color:var(--muted)}
.gd-desc{color:var(--muted);font-size:.88rem;line-height:1.75;margin-bottom:18px}
.pkg-tabs{display:flex;gap:0;border-bottom:2px solid var(--border)}
.pkg-tab{padding:9px 18px;cursor:pointer;font-size:.83rem;border-bottom:2px solid transparent;margin-bottom:-2px;transition:.2s;color:var(--muted);font-weight:500}
.pkg-tab.active{color:var(--accent);border-bottom-color:var(--accent)}
.pkg-box{background:var(--surface);border:1px solid var(--border);border-radius:0 0 var(--r) var(--r);padding:18px;border-top:none}
.pkg-price{font-family:var(--font-display);font-weight:800;font-size:1.7rem;margin-bottom:5px}
.pkg-meta{font-size:.8rem;color:var(--muted);margin-bottom:13px;display:flex;gap:16px;flex-wrap:wrap}
.pkg-feat-list{list-style:none;margin-bottom:16px}
.pkg-feat-list li{padding:6px 0;font-size:.83rem;display:flex;align-items:center;gap:8px;border-bottom:1px solid var(--border)}
.pkg-feat-list li:last-child{border:none}
.chk{color:var(--success)}
.xchk{color:var(--muted2)}
.si-card{background:var(--surface);border:1px solid var(--border);border-radius:13px;padding:18px;margin-top:14px}
.si-top{display:flex;align-items:center;gap:11px;margin-bottom:13px}
.si-av{width:48px;height:48px;border-radius:50%;background:linear-gradient(135deg,var(--accent),var(--accent2));display:flex;align-items:center;justify-content:center;font-size:1.2rem;flex-shrink:0}
.si-name{font-family:var(--font-display);font-weight:600;font-size:.95rem}
.si-meta{font-size:.73rem;color:var(--muted);margin-top:2px}
.si-stats-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:13px}
.si-stat-box{text-align:center;padding:9px;background:var(--surface2);border-radius:9px}
.si-stat-box strong{display:block;color:var(--accent);font-family:var(--font-display);font-size:.92rem}
.si-stat-box small{font-size:.68rem;color:var(--muted)}
.reviews{margin-top:18px}
.rev-item{padding:13px 0;border-bottom:1px solid var(--border)}
.rev-item:last-child{border:none}
.rev-top{display:flex;align-items:center;gap:9px;margin-bottom:7px}
.rev-av{width:30px;height:30px;border-radius:50%;background:linear-gradient(135deg,var(--accent3),var(--accent2));display:flex;align-items:center;justify-content:center;font-size:.75rem;font-weight:700;color:#000}
.rev-name{font-size:.83rem;font-weight:500}
.rev-date{font-size:.72rem;color:var(--muted);margin-left:auto}
.stars{color:var(--gold);font-size:.77rem;letter-spacing:1px}
.rev-txt{font-size:.83rem;color:var(--muted);line-height:1.65}

/* CHECKOUT */
.co-grid{display:grid;grid-template-columns:1fr 350px;gap:26px;align-items:start}
@media(max-width:700px){.co-grid{grid-template-columns:1fr}}
.co-section{background:var(--surface);border:1px solid var(--border);border-radius:var(--r);padding:22px;margin-bottom:16px}
.co-section h3{font-family:var(--font-display);font-weight:600;font-size:1rem;margin-bottom:18px;display:flex;align-items:center;gap:8px}
.step-num-circle{width:24px;height:24px;border-radius:50%;background:linear-gradient(135deg,var(--accent),var(--accent2));display:inline-flex;align-items:center;justify-content:center;font-size:.72rem;font-weight:700;color:#000;flex-shrink:0}

/* PAYMENT METHODS */
.pm-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(130px,1fr));gap:8px;margin-bottom:14px}
.pm-opt{padding:10px 8px;border-radius:10px;border:1px solid var(--border);background:var(--surface);cursor:pointer;text-align:center;font-size:.77rem;color:var(--muted);transition:.2s;user-select:none}
.pm-opt:hover{border-color:var(--border2);color:var(--text)}
.pm-opt.active{border-color:var(--accent);color:var(--accent);background:rgba(110,255,212,.06)}
.pm-opt .pm-icon{font-size:1.4rem;display:block;margin-bottom:4px}
.pm-detail{background:var(--surface2);border:1px solid var(--border);border-radius:11px;padding:16px;min-height:80px}
.pm-detail h4{font-size:.83rem;color:var(--accent);margin-bottom:12px;display:flex;align-items:center;gap:8px}

/* BANK CARD FORM */
.card-chip{display:flex;align-items:center;gap:12px;margin-bottom:16px}
.chip-icon{width:36px;height:28px;border-radius:6px;background:linear-gradient(135deg,var(--gold),#f97316);display:flex;align-items:center;justify-content:center;font-size:.7rem;font-family:var(--font-mono)}
.card-network{font-family:var(--font-mono);font-size:.72rem;color:var(--muted)}
.card-num-input{letter-spacing:3px;font-family:var(--font-mono);font-size:1rem}
.fpx-bank-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(110px,1fr));gap:7px;max-height:220px;overflow-y:auto}
.fpx-bank-btn{padding:8px 6px;border-radius:9px;border:1px solid var(--border);background:var(--surface);cursor:pointer;text-align:center;font-size:.72rem;color:var(--muted);transition:.2s}
.fpx-bank-btn:hover,.fpx-bank-btn.active{border-color:var(--accent);color:var(--accent);background:rgba(110,255,212,.06)}
.fpx-bank-btn .bank-logo{font-size:1.2rem;display:block;margin-bottom:3px}

/* TAX / INVOICE BOX */
.tax-box{background:rgba(110,255,212,.04);border:1px solid rgba(110,255,212,.12);border-radius:11px;padding:16px;margin-bottom:14px}
.tax-box h4{font-size:.83rem;color:var(--accent);margin-bottom:10px;display:flex;align-items:center;gap:7px}
.tax-row{display:flex;justify-content:space-between;font-size:.82rem;padding:5px 0;border-bottom:1px solid rgba(255,255,255,.05)}
.tax-row:last-child{border:none}
.tax-row.total-row{font-family:var(--font-display);font-weight:700;font-size:.95rem;padding-top:10px;margin-top:4px;border-top:1px solid var(--border2)}
.tax-row .label{color:var(--muted)}
.tax-row .val{color:var(--text);font-family:var(--font-mono);font-size:.82rem}
.tax-row.total-row .val{color:var(--accent);font-size:.95rem}

/* ORDER SUMMARY STICKY */
.order-summary{background:var(--surface);border:1px solid var(--border);border-radius:var(--r);padding:20px;position:sticky;top:82px}
.os-title{font-family:var(--font-display);font-weight:600;margin-bottom:16px;font-size:.95rem}
.os-gig{display:flex;gap:12px;padding:12px;background:var(--surface2);border-radius:10px;margin-bottom:14px}
.os-gig-emoji{font-size:2.2rem;flex-shrink:0}
.os-gig-title{font-size:.83rem;font-weight:500;margin-bottom:3px}
.os-gig-meta{font-size:.73rem;color:var(--muted)}

/* E-INVOICE / LHDN */
.einv-badge{display:inline-flex;align-items:center;gap:6px;padding:4px 12px;border-radius:999px;background:rgba(251,146,60,.08);border:1px solid rgba(251,146,60,.2);font-size:.72rem;color:var(--warn);margin-bottom:12px}
.einv-fields{background:rgba(251,146,60,.04);border:1px solid rgba(251,146,60,.12);border-radius:11px;padding:16px}
.einv-fields h4{font-size:.83rem;color:var(--warn);margin-bottom:12px;display:flex;align-items:center;gap:7px}
.optional-toggle{font-size:.77rem;color:var(--accent);cursor:pointer;text-decoration:underline;margin-bottom:10px;display:inline-block}

/* ORDERS */
.order-tabs{display:flex;gap:3px;margin-bottom:22px;background:var(--surface);border-radius:11px;padding:4px}
.order-tab{padding:8px 14px;border-radius:9px;cursor:pointer;font-size:.83rem;color:var(--muted);transition:.2s;flex:1;text-align:center;font-weight:500}
.order-tab.active{background:var(--surface2);color:var(--text)}
.order-card{background:var(--surface);border:1px solid var(--border);border-radius:13px;padding:18px;margin-bottom:10px;display:flex;align-items:center;gap:15px;cursor:pointer;transition:.2s}
.order-card:hover{border-color:var(--border2);box-shadow:var(--shadow)}
.oc-thumb{width:76px;height:56px;border-radius:9px;flex-shrink:0;background:var(--surface2);display:flex;align-items:center;justify-content:center;font-size:1.7rem}
.oc-info{flex:1}
.oc-title{font-weight:500;margin-bottom:3px;font-size:.9rem}
.oc-meta{font-size:.77rem;color:var(--muted)}
.oc-right{display:flex;flex-direction:column;align-items:flex-end;gap:7px}
.status-pill{padding:4px 11px;border-radius:999px;font-size:.72rem;font-weight:600}
.sp-active{background:rgba(74,222,128,.08);color:var(--success);border:1px solid rgba(74,222,128,.18)}
.sp-review{background:rgba(251,191,36,.08);color:var(--gold);border:1px solid rgba(251,191,36,.18)}
.sp-complete{background:rgba(110,255,212,.08);color:var(--accent);border:1px solid rgba(110,255,212,.18)}
.sp-cancel{background:rgba(248,113,113,.08);color:var(--danger);border:1px solid rgba(248,113,113,.18)}
.sp-dispute{background:rgba(167,139,250,.08);color:var(--accent2);border:1px solid rgba(167,139,250,.18)}

/* CHAT */
.chat-layout{display:grid;grid-template-columns:270px 1fr;height:580px;border:1px solid var(--border);border-radius:var(--r);overflow:hidden}
.chat-sb{background:rgba(0,0,0,.3);border-right:1px solid var(--border);overflow-y:auto}
.chat-sb-hd{padding:14px 16px;border-bottom:1px solid var(--border);font-weight:600;font-size:.87rem;display:flex;align-items:center;justify-content:space-between}
.chat-con{display:flex;align-items:center;gap:9px;padding:11px 15px;cursor:pointer;transition:.15s}
.chat-con:hover,.chat-con.active{background:var(--surface2)}
.chat-con-av{width:36px;height:36px;border-radius:50%;flex-shrink:0;background:linear-gradient(135deg,var(--accent),var(--accent2));display:flex;align-items:center;justify-content:center;font-size:.85rem;position:relative}
.online-dot{width:9px;height:9px;background:var(--success);border-radius:50%;border:2px solid #0d0d26;position:absolute;bottom:0;right:0}
.chat-con-name{font-size:.83rem;font-weight:500}
.chat-con-last{font-size:.72rem;color:var(--muted);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:120px;margin-top:1px}
.chat-con-time{font-size:.68rem;color:var(--muted2);margin-left:auto;white-space:nowrap}
.chat-main-area{display:flex;flex-direction:column;background:rgba(0,0,0,.18)}
.chat-hd{padding:13px 18px;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:11px}
.chat-hd-av{width:34px;height:34px;border-radius:50%;background:linear-gradient(135deg,var(--accent),var(--accent2));display:flex;align-items:center;justify-content:center;font-size:.85rem}
.chat-hd-name{font-weight:600;font-size:.88rem}
.chat-hd-status{font-size:.72rem;color:var(--success)}
.chat-msgs{flex:1;overflow-y:auto;padding:14px;scrollbar-width:thin;scrollbar-color:var(--border) transparent;display:flex;flex-direction:column;gap:10px}
.msg{display:flex;gap:7px;align-items:flex-end;max-width:80%}
.msg.me{flex-direction:row-reverse;align-self:flex-end}
.msg.them{align-self:flex-start}
.msg-av{width:26px;height:26px;border-radius:50%;flex-shrink:0;background:linear-gradient(135deg,var(--accent3),var(--accent2));display:flex;align-items:center;justify-content:center;font-size:.62rem;color:#000;font-weight:700}
.msg-bubble{padding:9px 13px;border-radius:13px;font-size:.83rem;line-height:1.55}
.msg.them .msg-bubble{background:var(--surface2);border-bottom-left-radius:4px}
.msg.me .msg-bubble{background:linear-gradient(135deg,rgba(110,255,212,.18),rgba(167,139,250,.18));border:1px solid rgba(110,255,212,.15);border-bottom-right-radius:4px;color:var(--text)}
.msg-time{font-size:.62rem;color:var(--muted2);margin-top:3px;text-align:right}
.chat-inp-row{padding:12px 14px;border-top:1px solid var(--border);display:flex;gap:7px}
.chat-inp{flex:1;padding:9px 13px;border-radius:11px;background:var(--surface2);border:1px solid var(--border);color:var(--text);font-family:var(--font-body);font-size:.88rem;outline:none;transition:.2s}
.chat-inp:focus{border-color:var(--accent)}
.chat-send-btn{padding:9px 16px;border-radius:11px;border:none;background:linear-gradient(135deg,var(--accent),var(--accent2));color:#000;font-weight:700;cursor:pointer;font-size:.83rem;transition:.2s}
.chat-send-btn:hover{opacity:.88}

/* POST GIG */
.pg-steps{display:flex;gap:0;margin-bottom:26px;background:var(--surface);border-radius:11px;padding:4px}
.pg-step{flex:1;padding:10px 14px;text-align:center;border-radius:9px;color:var(--muted);font-size:.78rem;cursor:pointer;transition:.2s;user-select:none}
.pg-step.active{background:var(--surface2);color:var(--accent)}
.pg-step.done{color:var(--success)}
.pg-step-n{width:22px;height:22px;border-radius:50%;background:var(--surface2);display:inline-flex;align-items:center;justify-content:center;font-size:.72rem;margin-bottom:3px}
.pg-step.active .pg-step-n{background:rgba(110,255,212,.15);color:var(--accent)}
.pg-step.done .pg-step-n{background:rgba(74,222,128,.15);color:var(--success)}

/* PROFILE */
.prof-banner{height:160px;border-radius:var(--r);margin-bottom:18px;background:linear-gradient(135deg,rgba(110,255,212,.08),rgba(167,139,250,.08),rgba(244,114,182,.08));border:1px solid var(--border);display:flex;align-items:center;justify-content:center;font-size:3.5rem;position:relative;overflow:hidden}
.prof-banner::before{content:'';position:absolute;inset:0;background:radial-gradient(ellipse at 30% 50%,rgba(110,255,212,.05),transparent)}
.prof-info{display:flex;align-items:flex-end;gap:18px;margin-bottom:22px;flex-wrap:wrap}
.prof-av{width:84px;height:84px;border-radius:50%;margin-top:-42px;background:linear-gradient(135deg,var(--accent),var(--accent2));display:flex;align-items:center;justify-content:center;font-size:2rem;border:4px solid var(--bg);box-shadow:0 0 28px rgba(110,255,212,.18);flex-shrink:0}
.prof-name{font-family:var(--font-display);font-weight:700;font-size:1.25rem}
.prof-meta{font-size:.82rem;color:var(--muted);margin-top:2px}
.prof-tabs{display:flex;gap:0;border-bottom:1px solid var(--border);margin-bottom:22px}
.prof-tab{padding:9px 18px;cursor:pointer;font-size:.83rem;color:var(--muted);border-bottom:2px solid transparent;margin-bottom:-1px;transition:.2s;font-weight:500}
.prof-tab.active{color:var(--accent);border-bottom-color:var(--accent)}
.stats-row{display:grid;grid-template-columns:repeat(4,1fr);gap:11px;margin-bottom:22px}
@media(max-width:600px){.stats-row{grid-template-columns:1fr 1fr}}
.stat-box{background:var(--surface);border:1px solid var(--border);border-radius:13px;padding:15px;text-align:center}
.stat-box .n{font-family:var(--font-display);font-weight:800;font-size:1.55rem;color:var(--accent)}
.stat-box .l{font-size:.72rem;color:var(--muted);margin-top:2px}

/* WALLET / EARNINGS */
.wallet-card{background:linear-gradient(135deg,rgba(110,255,212,.1),rgba(167,139,250,.08));border:1px solid rgba(110,255,212,.15);border-radius:var(--r);padding:24px;margin-bottom:16px}
.wallet-balance{font-family:var(--font-display);font-weight:800;font-size:2.4rem;color:var(--accent);margin-bottom:4px}
.wallet-label{font-size:.8rem;color:var(--muted)}
.tx-item{display:flex;align-items:center;gap:12px;padding:12px 0;border-bottom:1px solid var(--border)}
.tx-item:last-child{border:none}
.tx-icon{width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.9rem;flex-shrink:0}
.tx-in{background:rgba(74,222,128,.1)}
.tx-out{background:rgba(248,113,113,.1)}
.tx-info{flex:1}
.tx-title{font-size:.85rem;font-weight:500;margin-bottom:2px}
.tx-meta{font-size:.72rem;color:var(--muted)}
.tx-amount{font-family:var(--font-mono);font-weight:600;font-size:.88rem}
.tx-amount.in{color:var(--success)}
.tx-amount.out{color:var(--danger)}

/* E-INVOICE MODAL */
.einv-qr{width:140px;height:140px;background:#fff;border-radius:12px;margin:0 auto 14px;display:flex;align-items:center;justify-content:center;font-size:.65rem;color:#000;text-align:center;padding:10px;font-family:var(--font-mono)}
.einv-info-table{width:100%;font-size:.82rem;border-collapse:collapse}
.einv-info-table td{padding:7px 10px;border-bottom:1px solid var(--border)}
.einv-info-table td:first-child{color:var(--muted);width:45%}
.einv-info-table td:last-child{font-family:var(--font-mono);color:var(--text)}
.lhdn-badge{display:inline-flex;align-items:center;gap:7px;padding:5px 13px;border-radius:999px;background:rgba(251,146,60,.1);border:1px solid rgba(251,146,60,.2);font-size:.75rem;color:var(--warn);margin-bottom:14px}

/* DISPUTE */
.dispute-timeline{position:relative;padding-left:24px}
.dispute-timeline::before{content:'';position:absolute;left:8px;top:0;bottom:0;width:2px;background:var(--border)}
.dt-item{position:relative;margin-bottom:18px}
.dt-dot{width:16px;height:16px;border-radius:50%;background:var(--accent);position:absolute;left:-20px;top:2px;border:2px solid var(--bg)}
.dt-time{font-size:.7rem;color:var(--muted);margin-bottom:3px}
.dt-text{font-size:.83rem;line-height:1.6}

/* TOAST */
.toast-wrap{position:fixed;bottom:22px;right:22px;z-index:9999;display:flex;flex-direction:column;gap:7px;pointer-events:none}
.toast{padding:11px 18px;border-radius:11px;border:1px solid;font-size:.83rem;display:flex;align-items:center;gap:9px;min-width:250px;max-width:360px;animation:toastIn .3s ease;pointer-events:all;box-shadow:0 8px 24px rgba(0,0,0,.4)}
.toast-success{background:rgba(74,222,128,.1);border-color:rgba(74,222,128,.2);color:var(--success)}
.toast-error{background:rgba(248,113,113,.1);border-color:rgba(248,113,113,.2);color:var(--danger)}
.toast-info{background:rgba(110,255,212,.1);border-color:rgba(110,255,212,.2);color:var(--accent)}
.toast-warn{background:rgba(251,146,60,.1);border-color:rgba(251,146,60,.2);color:var(--warn)}
@keyframes toastIn{from{transform:translateX(100%);opacity:0}to{transform:none;opacity:1}}

/* NOTICE */
.notice{display:flex;align-items:flex-start;gap:10px;padding:13px 16px;border-radius:10px;font-size:.82rem;line-height:1.6;margin-bottom:14px}
.notice-info{background:rgba(56,189,248,.07);border:1px solid rgba(56,189,248,.18);color:var(--accent4)}
.notice-warn{background:rgba(251,146,60,.07);border:1px solid rgba(251,146,60,.18);color:var(--warn)}
.notice-success{background:rgba(74,222,128,.07);border:1px solid rgba(74,222,128,.18);color:var(--success)}

/* DIVIDER */
hr{border:none;border-top:1px solid var(--border);margin:18px 0}
.divider-text{display:flex;align-items:center;gap:12px;margin:16px 0;font-size:.77rem;color:var(--muted)}
.divider-text::before,.divider-text::after{content:'';flex:1;height:1px;background:var(--border)}

/* RESPONSIVE */
@media(max-width:900px){
  header{padding:0 14px}
  .hdr-search{display:none}
  .hdr-nav a:not(.active){display:none}
  .wrap{padding:0 14px}
  .hero{padding:38px 14px 38px}
  .cat-scroll{padding:0 14px 12px}
  .co-grid{grid-template-columns:1fr}
  .chat-layout{grid-template-columns:1fr;height:auto}
  .chat-sb{display:none}
  .input-2,.input-3{grid-template-columns:1fr}
  .gd-grid{grid-template-columns:1fr}
}

/* FOOTER */
footer{border-top:1px solid var(--border);padding:42px 0 22px;position:relative;z-index:1;background:rgba(6,6,26,.92)}
.foot-grid{display:grid;grid-template-columns:2fr 1fr 1fr 1fr;gap:36px;margin-bottom:28px}
@media(max-width:700px){.foot-grid{grid-template-columns:1fr;gap:18px}}
.foot-brand p{font-size:.8rem;color:var(--muted);line-height:1.7;max-width:260px;margin-top:9px}
.foot-col h4{font-family:var(--font-display);font-size:.83rem;margin-bottom:11px}
.foot-col a{display:block;color:var(--muted);font-size:.78rem;text-decoration:none;padding:3px 0;transition:.2s;cursor:pointer}
.foot-col a:hover{color:var(--accent)}
.foot-bottom{border-top:1px solid var(--border);padding-top:16px;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:8px}
.foot-bottom p{font-size:.73rem;color:var(--muted2)}
.lang-sel{padding:5px 11px;border-radius:7px;background:var(--surface);border:1px solid var(--border);color:var(--muted);font-size:.73rem;cursor:pointer;font-family:var(--font-body)}
.lang-sel option{background:#1a1a3d}
</style>
</head>
<body>

<!-- Stars -->
<div class="stars-bg" id="starsBg"></div>

<!-- Toast Container -->
<div class="toast-wrap" id="toastWrap"></div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• HEADER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<header>
  <div class="logo" onclick="nav('home')">
    <div class="logo-icon">NS</div>
    <div><span class="logo-text">NovaServe</span><span class="logo-sub">æ˜ŸåŸŸè‡ªç”±èŒä¸šå¹³å° Â· MY</span></div>
  </div>
  <div class="hdr-search">
    <input id="hdrQ" placeholder="æœç´¢æœåŠ¡ã€æŠ€èƒ½ã€å–å®¶â€¦" onkeydown="if(event.key==='Enter')search()">
    <button class="hdr-search-btn" onclick="search()">æœç´¢</button>
  </div>
  <nav class="hdr-nav">
    <a id="hn-home" onclick="nav('home')" class="active">é¦–é¡µ</a>
    <a id="hn-orders" onclick="nav('orders')">æˆ‘çš„è®¢å•</a>
    <a id="hn-chat" onclick="nav('chat')">æ¶ˆæ¯</a>
    <a id="hn-post" onclick="nav('post')">å‘å¸ƒ Gig</a>
    <a id="hn-wallet" onclick="nav('wallet')">é’±åŒ…</a>
  </nav>
  <div class="hdr-actions">
    <div id="hdrNotif" class="icon-btn" onclick="showToast('æ‚¨æœ‰ 3 æ¡æ–°é€šçŸ¥','info')" style="display:none">ğŸ””<span class="dot-badge"></span></div>
    <div id="hdrCart" class="icon-btn" onclick="nav('checkout')" style="display:none">ğŸ›’<span id="cartDot" class="dot-badge" style="display:none"></span></div>
    <div id="authBtns" style="display:flex;gap:6px">
      <button class="btn-hdr btn-login" onclick="openM('loginModal')">ç™»å½•</button>
      <button class="btn-hdr btn-signup" onclick="openM('regModal')">æ³¨å†Œ</button>
    </div>
    <div id="userAvBtn" class="avatar-btn" onclick="nav('profile')" style="display:none" title="ä¸ªäººä¸­å¿ƒ">ME</div>
  </div>
</header>

<main>
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• HOME â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="page-home" class="page active">
  <div class="hero">
    <div class="hero-tag">âœ¨ é©¬æ¥è¥¿äºšé¢†å…ˆæ•°å­—æœåŠ¡å¹³å° Â· LHDN e-Invoice åˆè§„</div>
    <h1>æ‰¾åˆ°å®Œç¾çš„<br><span class="grad">è‡ªç”±èŒä¸šæœåŠ¡</span></h1>
    <p class="hero-sub">æ¸¸æˆã€ç¼–ç¨‹ã€è®¾è®¡ã€å åœ â€” æ•°åƒåä¸“ä¸šè‡ªç”±èŒä¸šè€…éšæ—¶ä¸ºæ‚¨æœåŠ¡ã€‚æ”¯æŒ FPX / DuitNow / ä¿¡ç”¨å¡ã€‚</p>
    <div class="hero-form">
      <select id="heroCat"><option>å…¨éƒ¨åˆ†ç±»</option><option>ğŸ® æ¸¸æˆä»£æ‰“</option><option>ğŸ’ æ¸¸æˆä»£å……</option><option>ğŸ’» ç¼–ç¨‹</option><option>ğŸ¨ è®¾è®¡</option><option>ğŸ”® å åœ</option><option>ğŸ“ æ–‡æ¡ˆ</option></select>
      <input id="heroQ" placeholder="æˆ‘éœ€è¦å¸®åŠ©â€¦ ä¾‹å¦‚ï¼šç‹è€…è£è€€ä»£æ‰“">
      <button onclick="search()">æœç´¢ ğŸ”</button>
    </div>
    <div class="hero-stats">
      <div><div class="h-stat-num">12.4K+</div><div class="h-stat-lbl">æ´»è·ƒä¹°å®¶</div></div>
      <div><div class="h-stat-num">3.2K+</div><div class="h-stat-lbl">ä¸“ä¸šå–å®¶</div></div>
      <div><div class="h-stat-num">28K+</div><div class="h-stat-lbl">å®Œæˆè®¢å•</div></div>
      <div><div class="h-stat-num">4.9â˜…</div><div class="h-stat-lbl">å¹³å‡è¯„åˆ†</div></div>
    </div>
  </div>

  <div class="cat-scroll">
    <div class="cat-pill active" onclick="filterCat(this,'all')">ğŸŒŸ å…¨éƒ¨</div>
    <div class="cat-pill" onclick="filterCat(this,'game')">ğŸ® æ¸¸æˆä»£æ‰“</div>
    <div class="cat-pill" onclick="filterCat(this,'topup')">ğŸ’ æ¸¸æˆä»£å……</div>
    <div class="cat-pill" onclick="filterCat(this,'code')">ğŸ’» ç¼–ç¨‹å¼€å‘</div>
    <div class="cat-pill" onclick="filterCat(this,'design')">ğŸ¨ è®¾è®¡åˆ›ä½œ</div>
    <div class="cat-pill" onclick="filterCat(this,'tarot')">ğŸ”® å åœè§£è¯»</div>
    <div class="cat-pill" onclick="filterCat(this,'writing')">ğŸ“ æ–‡æ¡ˆå†™ä½œ</div>
    <div class="cat-pill" onclick="filterCat(this,'marketing')">ğŸ“£ æ•°å­—è¥é”€</div>
    <div class="cat-pill" onclick="filterCat(this,'video')">ğŸ¬ è§†é¢‘å‰ªè¾‘</div>
  </div>

  <div class="wrap">
    <section><div class="sec-hd"><h2 class="sec-title">ğŸ”¥ çƒ­é—¨æœåŠ¡</h2><a class="sec-link" onclick="nav('browse')">æŸ¥çœ‹å…¨éƒ¨ â†’</a></div><div class="gig-grid" id="homeGigs"></div></section>
    <section><div class="sec-hd"><h2 class="sec-title">â­ ç²¾é€‰å–å®¶</h2><a class="sec-link">æŸ¥çœ‹æ›´å¤š â†’</a></div><div class="seller-grid" id="homeSellers"></div></section>
    <section><div class="sec-hd"><h2 class="sec-title">ğŸ†• æœ€æ–°ä¸Šæ¶</h2><a class="sec-link" onclick="nav('browse')">å…¨éƒ¨ â†’</a></div><div class="gig-grid" id="newGigs"></div></section>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• BROWSE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="page-browse" class="page">
  <div class="wrap" style="padding-top:28px">
    <div class="sec-hd">
      <h2 class="sec-title" id="browseTitle">å…¨éƒ¨ Gig</h2>
      <select class="form-input" style="width:auto;padding:8px 13px;font-size:.8rem" onchange="sortGigs(this.value)">
        <option value="">æœ€ç›¸å…³</option><option value="rating">è¯„åˆ†æœ€é«˜</option>
        <option value="price_low">ä»·æ ¼ï¼šä½â†’é«˜</option><option value="price_high">ä»·æ ¼ï¼šé«˜â†’ä½</option><option value="newest">æœ€æ–°</option>
      </select>
    </div>
    <div class="gig-grid" id="browseGigs"></div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• ORDERS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="page-orders" class="page">
  <div class="wrap" style="padding-top:28px">
    <div class="sec-hd"><h2 class="sec-title">ğŸ“¦ æˆ‘çš„è®¢å•</h2>
      <button class="btn btn-secondary btn-sm" onclick="openM('einvListModal')">ğŸ“„ e-Invoice è®°å½•</button>
    </div>
    <div class="order-tabs">
      <div class="order-tab active" onclick="filterOrders('all',this)">å…¨éƒ¨</div>
      <div class="order-tab" onclick="filterOrders('active',this)">è¿›è¡Œä¸­</div>
      <div class="order-tab" onclick="filterOrders('review',this)">å¾…ç¡®è®¤</div>
      <div class="order-tab" onclick="filterOrders('complete',this)">å·²å®Œæˆ</div>
      <div class="order-tab" onclick="filterOrders('dispute',this)">çº çº·</div>
    </div>
    <div id="ordersList"></div>
    <div id="ordersEmpty" style="display:none;text-align:center;padding:56px 0;color:var(--muted)">
      <div style="font-size:3rem;margin-bottom:12px">ğŸ“­</div><p>è¿˜æ²¡æœ‰è®¢å•</p>
      <button class="btn btn-primary" style="margin:16px auto;max-width:180px" onclick="nav('home')">æµè§ˆæœåŠ¡</button>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CHAT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="page-chat" class="page">
  <div class="wrap" style="padding-top:28px">
    <div class="sec-hd"><h2 class="sec-title">ğŸ’¬ æ¶ˆæ¯ä¸­å¿ƒ</h2></div>
    <div class="chat-layout">
      <div class="chat-sb">
        <div class="chat-sb-hd">è”ç³»äºº <span style="font-size:.72rem;color:var(--muted)">åœ¨çº¿ 3</span></div>
        <div id="chatContacts"></div>
      </div>
      <div class="chat-main-area">
        <div class="chat-hd" id="chatHd"><div style="font-size:1.1rem">ğŸ’¬</div><div><div class="chat-hd-name">è¯·é€‰æ‹©è”ç³»äºº</div><div class="chat-hd-status">â€”</div></div></div>
        <div class="chat-msgs" id="chatMsgs"><div style="text-align:center;padding:40px;color:var(--muted);font-size:.83rem">é€‰æ‹©å·¦ä¾§è”ç³»äººå¼€å§‹èŠå¤©</div></div>
        <div class="chat-inp-row">
          <input class="chat-inp" id="chatInp" placeholder="è¾“å…¥æ¶ˆæ¯â€¦" onkeydown="if(event.key==='Enter')sendMsg()">
          <button class="chat-send-btn" onclick="sendMsg()">å‘é€</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• POST GIG â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="page-post" class="page">
  <div class="wrap" style="padding-top:28px;max-width:820px">
    <div class="sec-hd"><h2 class="sec-title">ğŸ“¢ å‘å¸ƒä½ çš„ Gig</h2></div>
    <div class="pg-steps" id="pgSteps">
      <div class="pg-step active" onclick="goStep(1)"><div class="pg-step-n">1</div><br>åŸºæœ¬ä¿¡æ¯</div>
      <div class="pg-step" onclick="goStep(2)"><div class="pg-step-n">2</div><br>æœåŠ¡å¥—é¤</div>
      <div class="pg-step" onclick="goStep(3)"><div class="pg-step-n">3</div><br>ç¨åŠ¡ä¿¡æ¯</div>
      <div class="pg-step" onclick="goStep(4)"><div class="pg-step-n">4</div><br>å‘å¸ƒé¢„è§ˆ</div>
    </div>
    <div id="postStep1" class="card">
      <div class="form-group"><label class="form-label">Gig æ ‡é¢˜ <span class="req">*</span></label><input class="form-input" id="pt" placeholder="ä¾‹å¦‚ï¼šæˆ‘å°†ä¸ºæ‚¨æä¾›ç‹è€…è£è€€ä¸“ä¸šä»£æ‰“æœåŠ¡"></div>
      <div class="form-group"><label class="form-label">æœåŠ¡åˆ†ç±» <span class="req">*</span></label>
        <select class="form-input" id="pc"><option value="">è¯·é€‰æ‹©</option><option value="game">ğŸ® æ¸¸æˆä»£æ‰“</option><option value="topup">ğŸ’ æ¸¸æˆä»£å……</option><option value="code">ğŸ’» ç¼–ç¨‹å¼€å‘</option><option value="design">ğŸ¨ è®¾è®¡</option><option value="tarot">ğŸ”® å åœ</option><option value="writing">ğŸ“ æ–‡æ¡ˆ</option><option value="marketing">ğŸ“£ è¥é”€</option><option value="video">ğŸ¬ è§†é¢‘</option></select>
      </div>
      <div class="form-group"><label class="form-label">æœåŠ¡æè¿° <span class="req">*</span></label><textarea class="form-input" id="pd" placeholder="è¯¦ç»†æè¿°æœåŠ¡å†…å®¹ã€æµç¨‹ã€ä¿éšœâ€¦" style="min-height:120px"></textarea></div>
      <div class="form-group"><label class="form-label">æŠ€èƒ½æ ‡ç­¾ï¼ˆé€—å·åˆ†éš”ï¼‰</label><input class="form-input" id="ptags" placeholder="ç‹è€…è£è€€, ä»£æ‰“, æ’ä½"></div>
      <div class="form-group"><label class="form-label">WhatsApp <span class="req">*</span></label><input class="form-input" id="pwa" placeholder="+6012xxxxxxxx"></div>
      <button class="btn btn-primary" onclick="goStep(2)">ä¸‹ä¸€æ­¥ â†’</button>
    </div>
    <div id="postStep2" class="card" style="display:none">
      <h3 style="font-family:var(--font-display);margin-bottom:18px">è®¾ç½®æœåŠ¡å¥—é¤</h3>
      <div class="input-3" style="display:grid;gap:14px">
        <div style="background:var(--surface2);border:1px solid var(--border);border-radius:11px;padding:16px">
          <div style="font-family:var(--font-display);font-weight:600;color:var(--accent);margin-bottom:12px">åŸºç¡€å¥—é¤</div>
          <div class="form-group"><label class="form-label">ä»·æ ¼ (RM)</label><input class="form-input" id="pp1" type="number" placeholder="50"></div>
          <div class="form-group"><label class="form-label">äº¤ä»˜å¤©æ•°</label><select class="form-input"><option>1å¤©</option><option>2å¤©</option><option>3å¤©</option><option>5å¤©</option><option>7å¤©</option></select></div>
          <div class="form-group"><label class="form-label">ä¿®æ”¹æ¬¡æ•°</label><select class="form-input"><option>1æ¬¡</option><option>2æ¬¡</option><option>3æ¬¡</option><option>æ— é™</option></select></div>
          <div class="form-group"><label class="form-label">å¥—é¤å†…å®¹</label><textarea class="form-input" style="min-height:60px" placeholder="åŸºç¡€åŠŸèƒ½ã€åŸºæœ¬æ”¯æŒâ€¦"></textarea></div>
        </div>
        <div style="background:var(--surface2);border:1px solid rgba(110,255,212,.18);border-radius:11px;padding:16px">
          <div style="font-family:var(--font-display);font-weight:600;color:var(--accent2);margin-bottom:12px">æ ‡å‡†å¥—é¤</div>
          <div class="form-group"><label class="form-label">ä»·æ ¼ (RM)</label><input class="form-input" id="pp2" type="number" placeholder="120"></div>
          <div class="form-group"><label class="form-label">äº¤ä»˜å¤©æ•°</label><select class="form-input"><option>1å¤©</option><option selected>3å¤©</option><option>5å¤©</option><option>7å¤©</option></select></div>
          <div class="form-group"><label class="form-label">ä¿®æ”¹æ¬¡æ•°</label><select class="form-input"><option>2æ¬¡</option><option selected>3æ¬¡</option><option>æ— é™</option></select></div>
          <div class="form-group"><label class="form-label">å¥—é¤å†…å®¹</label><textarea class="form-input" style="min-height:60px" placeholder="è¿›é˜¶åŠŸèƒ½ã€ä¼˜å…ˆæ”¯æŒâ€¦"></textarea></div>
        </div>
        <div style="background:var(--surface2);border:1px solid rgba(167,139,250,.18);border-radius:11px;padding:16px">
          <div style="font-family:var(--font-display);font-weight:600;color:var(--accent3);margin-bottom:12px">é«˜çº§å¥—é¤</div>
          <div class="form-group"><label class="form-label">ä»·æ ¼ (RM)</label><input class="form-input" id="pp3" type="number" placeholder="280"></div>
          <div class="form-group"><label class="form-label">äº¤ä»˜å¤©æ•°</label><select class="form-input"><option>5å¤©</option><option selected>7å¤©</option><option>14å¤©</option><option>30å¤©</option></select></div>
          <div class="form-group"><label class="form-label">ä¿®æ”¹æ¬¡æ•°</label><select class="form-input"><option selected>æ— é™</option></select></div>
          <div class="form-group"><label class="form-label">å¥—é¤å†…å®¹</label><textarea class="form-input" style="min-height:60px" placeholder="å…¨å¥—æœåŠ¡ã€ç»´æŠ¤æ”¯æŒâ€¦"></textarea></div>
        </div>
      </div>
      <div style="display:flex;gap:10px;margin-top:18px">
        <button class="btn btn-secondary" onclick="goStep(1)">â† ä¸Šä¸€æ­¥</button>
        <button class="btn btn-primary" onclick="goStep(3)">ä¸‹ä¸€æ­¥ â†’</button>
      </div>
    </div>
    <div id="postStep3" class="card" style="display:none">
      <h3 style="font-family:var(--font-display);margin-bottom:4px">ç¨åŠ¡ &amp; æ³•å¾‹ä¿¡æ¯</h3>
      <p style="font-size:.8rem;color:var(--muted);margin-bottom:18px">æ ¹æ®é©¬æ¥è¥¿äºšç¨æ³•ï¼Œå–å®¶éœ€æä¾›æ­£ç¡®ç¨åŠ¡ä¿¡æ¯ç”¨äº e-Invoice åˆè§„ã€‚</p>
      <div class="notice notice-warn">âš ï¸ é©¬æ¥è¥¿äºš LHDN è§„å®šï¼šå¹´æ”¶å…¥è¶…è¿‡ RM 150,000 çš„å–å®¶é¡»æ³¨å†Œ SSTã€‚NovaServe å°†ååŠ©ç”Ÿæˆ e-Invoice è®°å½•ä¾›æŠ¥ç¨ä½¿ç”¨ã€‚</div>
      <div class="form-group"><label class="form-label">çº³ç¨äººèº«ä»½</label>
        <select class="form-input" id="sellerTaxType" onchange="updateTaxForm()">
          <option value="individual">ä¸ªäººï¼ˆIndividualï¼‰</option>
          <option value="sole">ç‹¬èµ„ä¼ä¸šï¼ˆSole Proprietorï¼‰</option>
          <option value="company">ç§äººæœ‰é™å…¬å¸ï¼ˆSdn Bhdï¼‰</option>
          <option value="llp">æœ‰é™è´£ä»»åˆä¼™ï¼ˆLLPï¼‰</option>
        </select>
      </div>
      <div class="input-2" style="display:grid;gap:12px">
        <div class="form-group"><label class="form-label">NRIC / å…¬å¸æ³¨å†Œå· <span class="req">*</span></label><input class="form-input" id="sellerIC" placeholder="ä¾‹å¦‚ï¼š900101-14-1234"></div>
        <div class="form-group"><label class="form-label">å…¨å / å…¬å¸åç§°</label><input class="form-input" id="sellerLegalName" placeholder="å¦‚å®å¡«å†™èº«ä»½è¯/è¥ä¸šæ‰§ç…§åç§°"></div>
      </div>
      <div id="sstFields" style="display:none">
        <div class="form-group"><label class="form-label">SST æ³¨å†Œå·</label><input class="form-input" id="sellerSST" placeholder="ä¾‹å¦‚ï¼šW16-1234-12000001"></div>
      </div>
      <div class="form-group"><label class="form-label">çº³ç¨åœ°å€</label><textarea class="form-input" style="min-height:70px" id="sellerAddr" placeholder="Jalan xxx, Taman xxx, xxxxx Kuala Lumpurâ€¦"></textarea></div>
      <div class="form-group"><label class="form-label">é“¶è¡Œè´¦å·ï¼ˆæ”¶æ¬¾ç”¨ï¼‰</label>
        <select class="form-input" id="sellerBank" style="margin-bottom:8px"><option>Maybank</option><option>CIMB Bank</option><option>Public Bank</option><option>Hong Leong Bank</option><option>RHB Bank</option><option>AmBank</option><option>Bank Islam</option><option>Bank Rakyat</option></select>
        <input class="form-input" id="sellerBankAcc" placeholder="è´¦æˆ·å·ç ">
      </div>
      <div style="display:flex;gap:10px;margin-top:18px">
        <button class="btn btn-secondary" onclick="goStep(2)">â† ä¸Šä¸€æ­¥</button>
        <button class="btn btn-primary" onclick="goStep(4)">é¢„è§ˆ â†’</button>
      </div>
    </div>
    <div id="postStep4" class="card" style="display:none">
      <h3 style="font-family:var(--font-display);margin-bottom:16px">å‘å¸ƒé¢„è§ˆ</h3>
      <div id="postPreview" style="background:var(--surface2);border-radius:11px;padding:18px;margin-bottom:18px"></div>
      <div class="notice notice-info">â„¹ï¸ å‘å¸ƒåå°†æ˜¾ç¤ºåœ¨å¸‚åœºé¦–é¡µã€‚å¹³å°å°†æ”¶å– <strong>5% æœåŠ¡è´¹</strong>ã€‚SST é€‚ç”¨äºå·²æ³¨å†Œå–å®¶ã€‚</div>
      <div style="display:flex;gap:10px">
        <button class="btn btn-secondary" onclick="goStep(3)">â† ä¸Šä¸€æ­¥</button>
        <button class="btn btn-primary btn-lg" onclick="submitGig()">ğŸš€ ç«‹å³å‘å¸ƒ Gig</button>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CHECKOUT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="page-checkout" class="page">
  <div class="wrap" style="padding-top:28px">
    <div class="sec-hd"><h2 class="sec-title">ğŸ’³ å®‰å…¨ç»“è´¦</h2></div>
    <div class="co-grid">
      <!-- LEFT COLUMN -->
      <div>
        <!-- Step 1: Order Details -->
        <div class="co-section">
          <h3><span class="step-num-circle">1</span> ç¡®è®¤è®¢å•</h3>
          <div id="coGigInfo"></div>
          <div class="form-group"><label class="form-label">è®¢å•éœ€æ±‚è¯´æ˜ <span class="req">*</span></label><textarea class="form-input" id="coReq" placeholder="è¯·è¯¦ç»†æè¿°æ‚¨çš„éœ€æ±‚ï¼Œå¸®åŠ©å–å®¶æ›´å¥½åœ°å®Œæˆå·¥ä½œâ€¦" style="min-height:110px"></textarea></div>
        </div>

        <!-- Step 2: Buyer Info for e-Invoice -->
        <div class="co-section">
          <h3><span class="step-num-circle">2</span> ä¹°å®¶ä¿¡æ¯</h3>
          <div class="notice notice-info">â„¹ï¸ æ ¹æ® LHDN MyInvois ç³»ç»Ÿè¦æ±‚ï¼Œä¸‹å•é‡‘é¢ â‰¥ RM 200 æ—¶å°†è‡ªåŠ¨ç”Ÿæˆ e-Invoiceã€‚</div>
          <div class="input-2" style="display:grid;gap:12px">
            <div class="form-group"><label class="form-label">å§“å <span class="req">*</span></label><input class="form-input" id="buyerName" placeholder="å…¨åï¼ˆå¦‚èº«ä»½è¯æ‰€ç¤ºï¼‰"></div>
            <div class="form-group"><label class="form-label">NRIC / æŠ¤ç…§å·</label><input class="form-input" id="buyerIC" placeholder="900101-14-1234"></div>
          </div>
          <div class="form-group"><label class="form-label">ç”µå­é‚®ä»¶ <span class="req">*</span></label><input class="form-input" type="email" id="buyerEmail" placeholder="ç”¨äºæ¥æ”¶æ”¶æ® / e-Invoice"></div>
          <div class="form-group"><label class="form-label">æ‰‹æœºå·ç </label><input class="form-input" id="buyerPhone" placeholder="+6012xxxxxxxx"></div>
          <span class="optional-toggle" onclick="toggleEinvBiz()">ğŸ¢ å¡«å†™å…¬å¸ä¿¡æ¯ï¼ˆå¦‚éœ€å…¬å¸å‘ç¥¨ï¼‰</span>
          <div id="einvBizFields" style="display:none" class="einv-fields">
            <h4>ğŸ§¾ å…¬å¸/ä¸šåŠ¡ e-Invoice ä¿¡æ¯</h4>
            <div class="form-group"><label class="form-label">å…¬å¸åç§°</label><input class="form-input" id="bizName" placeholder="ABC Sdn Bhd"></div>
            <div class="input-2" style="display:grid;gap:12px">
              <div class="form-group"><label class="form-label">å…¬å¸æ³¨å†Œå· (ROC)</label><input class="form-input" id="bizROC" placeholder="ä¾‹å¦‚ï¼š1234567-W"></div>
              <div class="form-group"><label class="form-label">TINï¼ˆç¨åŠ¡è¯†åˆ«å·ï¼‰</label><input class="form-input" id="bizTIN" placeholder="C1234567890"></div>
            </div>
            <div class="form-group"><label class="form-label">SST æ³¨å†Œå·ï¼ˆå¦‚æœ‰ï¼‰</label><input class="form-input" id="bizSST" placeholder="W16-1234-12000001"></div>
            <div class="form-group"><label class="form-label">å…¬å¸åœ°å€</label><textarea class="form-input" style="min-height:70px" id="bizAddr" placeholder="No. xx, Jalan xxx, Taman xxxâ€¦"></textarea></div>
          </div>
        </div>

        <!-- Step 3: Payment -->
        <div class="co-section">
          <h3><span class="step-num-circle">3</span> é€‰æ‹©æ”¯ä»˜æ–¹å¼</h3>
          <div class="pm-grid" id="pmGrid">
            <div class="pm-opt active" onclick="selPM(this,'fpx')"><span class="pm-icon">ğŸ¦</span>FPX ç½‘é“¶</div>
            <div class="pm-opt" onclick="selPM(this,'duitnow')"><span class="pm-icon">ğŸ“²</span>DuitNow QR</div>
            <div class="pm-opt" onclick="selPM(this,'tng')"><span class="pm-icon">ğŸ’š</span>Touch 'n Go</div>
            <div class="pm-opt" onclick="selPM(this,'boost')"><span class="pm-icon">âš¡</span>Boost</div>
            <div class="pm-opt" onclick="selPM(this,'grabpay')"><span class="pm-icon">ğŸš—</span>GrabPay</div>
            <div class="pm-opt" onclick="selPM(this,'shopeepay')"><span class="pm-icon">ğŸ›</span>ShopeePay</div>
            <div class="pm-opt" onclick="selPM(this,'visa')"><span class="pm-icon">ğŸ’³</span>Visa / Mastercard</div>
            <div class="pm-opt" onclick="selPM(this,'amex')"><span class="pm-icon">ğŸ’ </span>Amex</div>
            <div class="pm-opt" onclick="selPM(this,'crypto')"><span class="pm-icon">â‚¿</span>Crypto USDT</div>
          </div>
          <div id="pmDetail" class="pm-detail"></div>
        </div>

        <!-- Step 4: Tax Breakdown -->
        <div class="co-section">
          <h3><span class="step-num-circle">4</span> ç¨è´¹æ˜ç»† &amp; e-Invoice</h3>
          <div class="tax-box">
            <h4>ğŸ§¾ é©¬æ¥è¥¿äºšç¨åŠ¡æ˜ç»† (MyInvois æ ‡å‡†)</h4>
            <div class="tax-row"><span class="label">æœåŠ¡é‡‘é¢ï¼ˆç¨å‰ï¼‰</span><span class="val" id="taxBase">RM 0.00</span></div>
            <div class="tax-row"><span class="label">å¹³å°æœåŠ¡è´¹ (5%)</span><span class="val" id="taxFee">RM 0.00</span></div>
            <div class="tax-row" id="sstRow"><span class="label">SST æœåŠ¡ç¨ (8%) <span style="font-size:.68rem;color:var(--muted)">Sales &amp; Services Tax</span></span><span class="val" id="taxSST">RM 0.00</span></div>
            <div class="tax-row" id="withholdRow"><span class="label">é¢„æ‰£ç¨ WHT (0%) <span style="font-size:.68rem;color:var(--muted)">é€‚ç”¨äºå¤–ç±å–å®¶</span></span><span class="val" id="taxWHT">RM 0.00</span></div>
            <div class="tax-row" id="stampRow"><span class="label">å°èŠ±ç¨ Stamp Duty</span><span class="val" id="taxStamp">RM 0.00</span></div>
            <div class="tax-row total-row"><span class="label">åˆè®¡ä»˜æ¬¾</span><span class="val" id="taxTotal">RM 0.00</span></div>
          </div>
          <div class="notice notice-success" id="einvNotice" style="display:none">âœ… æ­¤è®¢å•å°†è‡ªåŠ¨ç”Ÿæˆ <strong>LHDN e-Invoice</strong>ï¼ŒUUID ç¼–å·ä¼šåœ¨æ”¯ä»˜åå‘é€è‡³æ‚¨çš„é‚®ç®±ã€‚</div>
        </div>
      </div>

      <!-- RIGHT COLUMN: Summary -->
      <div>
        <div class="order-summary" id="orderSummary">
          <div class="os-title">è®¢å•æ‘˜è¦</div>
          <div class="os-gig" id="osSummaryGig"><div style="text-align:center;color:var(--muted);font-size:.82rem;width:100%;padding:12px 0">æœªé€‰æ‹©æœåŠ¡</div></div>
          <hr>
          <div class="tax-row"><span class="label">å°è®¡</span><span class="val" id="sumBase2">RM 0.00</span></div>
          <div class="tax-row"><span class="label">å¹³å°è´¹</span><span class="val" id="sumFee2">RM 0.00</span></div>
          <div class="tax-row"><span class="label">ç¨è´¹</span><span class="val" id="sumTax2">RM 0.00</span></div>
          <div class="tax-row total-row" style="margin-bottom:16px"><span>æ€»è®¡</span><span class="val" id="sumTotal2" style="color:var(--accent)">RM 0.00</span></div>
          <button class="btn btn-primary btn-full btn-lg" onclick="placeOrder()">ğŸ”’ ç¡®è®¤æ”¯ä»˜</button>
          <button class="btn btn-secondary btn-full" style="margin-top:8px" onclick="nav('home')">â† ç»§ç»­æµè§ˆ</button>
          <div style="text-align:center;margin-top:12px;font-size:.72rem;color:var(--muted)">ğŸ”’ æ”¯ä»˜å— 256-bit SSL åŠ å¯†ä¿æŠ¤<br>èµ„é‡‘ç”±å¹³å°æ‹…ä¿ Â· ä¸æ»¡æ„å…¨é¢é€€æ¬¾</div>
          <hr>
          <div style="font-size:.72rem;color:var(--muted);line-height:1.7">
            <strong style="color:var(--text)">ä¹°å®¶ä¿éšœ</strong><br>
            âœ“ å¹³å°æ‹…ä¿ä»˜æ¬¾<br>
            âœ“ 3 å¤©ç¡®è®¤æœŸ<br>
            âœ“ å…è´¹çº çº·è°ƒè§£<br>
            âœ“ ç”µå­æ”¶æ® / e-Invoice
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• WALLET â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="page-wallet" class="page">
  <div class="wrap" style="padding-top:28px;max-width:820px">
    <div class="sec-hd"><h2 class="sec-title">ğŸ’° é’±åŒ… &amp; æ”¶å…¥</h2><button class="btn btn-primary btn-sm" onclick="openM('withdrawModal')">ææ¬¾</button></div>
    <div class="wallet-card">
      <div class="wallet-label">å¯ææ¬¾ä½™é¢</div>
      <div class="wallet-balance" id="walletBal">RM 0.00</div>
      <div style="display:flex;gap:20px;margin-top:14px;flex-wrap:wrap">
        <div><div style="font-size:.75rem;color:var(--muted)">æœ¬æœˆæ”¶å…¥</div><div style="font-family:var(--font-display);font-weight:700;color:var(--success)">RM 0.00</div></div>
        <div><div style="font-size:.75rem;color:var(--muted)">å¾…ç»“ç®—</div><div style="font-family:var(--font-display);font-weight:700;color:var(--gold)">RM 0.00</div></div>
        <div><div style="font-size:.75rem;color:var(--muted)">æ€»æ”¶å…¥</div><div style="font-family:var(--font-display);font-weight:700">RM 0.00</div></div>
        <div><div style="font-size:.75rem;color:var(--muted)">å·²ç¼´ç¨</div><div style="font-family:var(--font-display);font-weight:700;color:var(--warn)">RM 0.00</div></div>
      </div>
    </div>
    <div class="notice notice-warn" style="margin-bottom:16px">âš ï¸ æ ¹æ® LHDN è§„å®šï¼Œå¹³å°å°†åœ¨æ”¶å…¥ç»“ç®—æ—¶æ‰£é™¤ç›¸åº”ç¨æ¬¾ã€‚å¹´æ”¶å…¥è¶…è¿‡ RM 34,000 é¡»è‡ªè¡Œç”³æŠ¥ä¸ªäººæ‰€å¾—ç¨ (BE Form)ã€‚</div>
    <div class="card">
      <div class="sec-hd" style="margin-bottom:16px"><h3 style="font-family:var(--font-display);font-size:.95rem">äº¤æ˜“è®°å½•</h3><button class="btn btn-secondary btn-sm" onclick="openM('taxReportModal')">ğŸ“Š ç¨åŠ¡æŠ¥å‘Š</button></div>
      <div id="txList"><div style="text-align:center;padding:32px;color:var(--muted)">æš‚æ— äº¤æ˜“è®°å½•</div></div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• PROFILE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="page-profile" class="page">
  <div class="wrap" style="padding-top:22px;max-width:900px">
    <div class="prof-banner">ğŸŒŒ</div>
    <div class="prof-info">
      <div class="prof-av" id="profAv">ğŸ‘¤</div>
      <div><div class="prof-name" id="profName">â€”</div><div class="prof-meta" id="profMeta">ä¹°å®¶ / å–å®¶ Â· é©¬æ¥è¥¿äºš</div></div>
      <div style="margin-left:auto;display:flex;gap:8px;align-items:center">
        <button class="btn btn-secondary btn-sm" onclick="openM('editProfModal')">âœï¸ ç¼–è¾‘</button>
        <button class="btn btn-secondary btn-sm" onclick="nav('wallet')">ğŸ’° é’±åŒ…</button>
      </div>
    </div>
    <div class="stats-row">
      <div class="stat-box"><div class="n" id="statOrders">0</div><div class="l">å®Œæˆè®¢å•</div></div>
      <div class="stat-box"><div class="n" style="color:var(--gold)" id="statRating">â€”</div><div class="l">è¯„åˆ†</div></div>
      <div class="stat-box"><div class="n" style="color:var(--accent2)" id="statGigs">0</div><div class="l">æ´»è·ƒ Gig</div></div>
      <div class="stat-box"><div class="n" style="color:var(--accent3)" id="statEarnings">RM 0</div><div class="l">æœ¬æœˆæ”¶å…¥</div></div>
    </div>
    <div class="prof-tabs">
      <div class="prof-tab active" onclick="profTab(this,'overview')">æ¦‚è§ˆ</div>
      <div class="prof-tab" onclick="profTab(this,'gigs')">æˆ‘çš„ Gig</div>
      <div class="prof-tab" onclick="profTab(this,'reviews')">è¯„ä»·</div>
      <div class="prof-tab" onclick="profTab(this,'tax')">ç¨åŠ¡æ–‡ä»¶</div>
      <div class="prof-tab" onclick="profTab(this,'settings')">è®¾ç½®</div>
    </div>
    <div id="profContent"></div>
  </div>
</div>
</main>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     MODALS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<!-- LOGIN -->
<div class="overlay" id="loginModal" onclick="if(e(event))closeM('loginModal')">
  <div class="modal" style="max-width:440px">
    <div class="modal-hd"><h2>ğŸ” ç™»å½•</h2><button class="modal-close" onclick="closeM('loginModal')">âœ•</button></div>
    <div class="modal-body">
      <div class="form-group"><label class="form-label">é‚®ç®± / æ‰‹æœºå·</label><input class="form-input" id="liEmail" type="email" placeholder="example@gmail.com"></div>
      <div class="form-group"><label class="form-label">å¯†ç </label><input class="form-input" id="liPass" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" onkeydown="if(event.key==='Enter')doLogin()"></div>
      <div style="display:flex;justify-content:flex-end;margin-bottom:14px"><a style="font-size:.78rem;color:var(--accent);cursor:pointer">å¿˜è®°å¯†ç ï¼Ÿ</a></div>
      <button class="btn btn-primary btn-full btn-lg" onclick="doLogin()">ç™»å½•</button>
      <div class="divider-text">æˆ–ä½¿ç”¨ç¬¬ä¸‰æ–¹ç™»å½•</div>
      <div class="input-3" style="display:grid;gap:7px;margin-bottom:14px">
        <button class="btn btn-secondary" onclick="socialLogin('Google')">ğŸŸ¢ Google</button>
        <button class="btn btn-secondary" onclick="socialLogin('Facebook')">ğŸ”µ Facebook</button>
        <button class="btn btn-secondary" onclick="socialLogin('Apple')">ğŸ Apple</button>
      </div>
      <p style="text-align:center;font-size:.78rem;color:var(--muted)">æ²¡æœ‰è´¦å·ï¼Ÿ<a style="color:var(--accent);cursor:pointer" onclick="closeM('loginModal');openM('regModal')">ç«‹å³æ³¨å†Œ</a></p>
    </div>
  </div>
</div>

<!-- REGISTER -->
<div class="overlay" id="regModal" onclick="if(e(event))closeM('regModal')">
  <div class="modal" style="max-width:500px">
    <div class="modal-hd"><h2>âœ¨ åˆ›å»ºè´¦å·</h2><button class="modal-close" onclick="closeM('regModal')">âœ•</button></div>
    <div class="modal-body">
      <div class="input-2" style="display:grid;gap:11px">
        <div class="form-group"><label class="form-label">å§“å <span class="req">*</span></label><input class="form-input" id="rName" placeholder="å…¨å"></div>
        <div class="form-group"><label class="form-label">ç”¨æˆ·å <span class="req">*</span></label><input class="form-input" id="rUser" placeholder="@username"></div>
      </div>
      <div class="form-group"><label class="form-label">é‚®ç®± <span class="req">*</span></label><input class="form-input" id="rEmail" type="email" placeholder="example@gmail.com"></div>
      <div class="form-group"><label class="form-label">æ‰‹æœºå·ï¼ˆWhatsAppï¼‰</label><input class="form-input" id="rPhone" placeholder="+6012xxxxxxxx"></div>
      <div class="form-group"><label class="form-label">å¯†ç  <span class="req">*</span></label><input class="form-input" id="rPass" type="password" placeholder="è‡³å°‘ 8 ä½ï¼Œå«å¤§å°å†™å’Œæ•°å­—"></div>
      <div class="form-group"><label class="form-label">æˆ‘çš„èº«ä»½</label>
        <div style="display:flex;gap:7px">
          <div class="pm-opt active" onclick="selRole(this,'buyer')" style="flex:1">ğŸ‘¤ ä¹°å®¶</div>
          <div class="pm-opt" onclick="selRole(this,'seller')" style="flex:1">ğŸ›ï¸ å–å®¶</div>
          <div class="pm-opt" onclick="selRole(this,'both')" style="flex:1">âš¡ ä¸¤è€…</div>
        </div>
      </div>
      <div style="background:rgba(110,255,212,.04);border:1px solid rgba(110,255,212,.12);border-radius:9px;padding:12px;margin-bottom:14px;font-size:.75rem;color:var(--muted)">
        æ³¨å†Œå³ä»£è¡¨æ‚¨åŒæ„ NovaServe <a style="color:var(--accent)">æœåŠ¡æ¡æ¬¾</a>ã€<a style="color:var(--accent)">éšç§æ”¿ç­–</a> åŠ <a style="color:var(--accent)">åæ´—é’±æ”¿ç­–</a>ï¼ˆAMLA åˆè§„ï¼‰
      </div>
      <button class="btn btn-primary btn-full btn-lg" onclick="doRegister()">åˆ›å»ºè´¦å· ğŸš€</button>
      <p style="text-align:center;font-size:.78rem;color:var(--muted);margin-top:11px">å·²æœ‰è´¦å·ï¼Ÿ<a style="color:var(--accent);cursor:pointer" onclick="closeM('regModal');openM('loginModal')">ç«‹å³ç™»å½•</a></p>
    </div>
  </div>
</div>

<!-- GIG DETAIL -->
<div class="overlay" id="gigModal" onclick="if(e(event))closeM('gigModal')">
  <div class="modal">
    <div class="modal-hd"><h2 id="gmTitle">æœåŠ¡è¯¦æƒ…</h2><button class="modal-close" onclick="closeM('gigModal')">âœ•</button></div>
    <div class="modal-body" id="gmBody"></div>
  </div>
</div>

<!-- e-INVOICE VIEW -->
<div class="overlay" id="einvModal" onclick="if(e(event))closeM('einvModal')">
  <div class="modal" style="max-width:620px">
    <div class="modal-hd"><h2>ğŸ§¾ e-Invoice (MyInvois)</h2><button class="modal-close" onclick="closeM('einvModal')">âœ•</button></div>
    <div class="modal-body" id="einvBody"></div>
  </div>
</div>

<!-- e-INVOICE LIST -->
<div class="overlay" id="einvListModal" onclick="if(e(event))closeM('einvListModal')">
  <div class="modal" style="max-width:680px">
    <div class="modal-hd"><h2>ğŸ“„ e-Invoice è®°å½•</h2><button class="modal-close" onclick="closeM('einvListModal')">âœ•</button></div>
    <div class="modal-body" id="einvListBody"></div>
  </div>
</div>

<!-- TAX REPORT -->
<div class="overlay" id="taxReportModal" onclick="if(e(event))closeM('taxReportModal')">
  <div class="modal" style="max-width:680px">
    <div class="modal-hd"><h2>ğŸ“Š å¹´åº¦ç¨åŠ¡æŠ¥å‘Š</h2><button class="modal-close" onclick="closeM('taxReportModal')">âœ•</button></div>
    <div class="modal-body" id="taxReportBody"></div>
  </div>
</div>

<!-- WITHDRAW -->
<div class="overlay" id="withdrawModal" onclick="if(e(event))closeM('withdrawModal')">
  <div class="modal" style="max-width:460px">
    <div class="modal-hd"><h2>ğŸ¦ ææ¬¾ç”³è¯·</h2><button class="modal-close" onclick="closeM('withdrawModal')">âœ•</button></div>
    <div class="modal-body">
      <div class="wallet-card" style="margin-bottom:16px;padding:16px">
        <div class="wallet-label">å¯ææ¬¾ä½™é¢</div>
        <div class="wallet-balance" style="font-size:1.8rem" id="wdBal">RM 0.00</div>
      </div>
      <div class="form-group"><label class="form-label">ææ¬¾é‡‘é¢ (RM) <span class="req">*</span></label><input class="form-input" id="wdAmt" type="number" placeholder="æœ€ä½ RM 50"></div>
      <div class="form-group"><label class="form-label">é“¶è¡Œ</label><select class="form-input" id="wdBank"><option>Maybank</option><option>CIMB Bank</option><option>Public Bank</option><option>Hong Leong Bank</option><option>RHB Bank</option><option>AmBank</option><option>Bank Islam</option><option>Bank Rakyat</option><option>Affin Bank</option><option>Alliance Bank</option></select></div>
      <div class="form-group"><label class="form-label">è´¦æˆ·å·ç  <span class="req">*</span></label><input class="form-input" id="wdAcc" placeholder="è´¦æˆ·å·ç "></div>
      <div class="form-group"><label class="form-label">è´¦æˆ·æŒæœ‰äººå§“å</label><input class="form-input" id="wdName" placeholder="å¦‚é“¶è¡Œè®°å½•æ‰€ç¤º"></div>
      <div class="tax-box" style="margin-bottom:14px">
        <h4>ğŸ’¸ ææ¬¾ç¨åŠ¡æ‰£é™¤</h4>
        <div class="tax-row"><span class="label">ææ¬¾é‡‘é¢</span><span class="val" id="wdTaxAmt">RM 0.00</span></div>
        <div class="tax-row"><span class="label">å¹³å°æœåŠ¡è´¹ (2%)</span><span class="val" id="wdTaxFee">RM 0.00</span></div>
        <div class="tax-row"><span class="label">é¢„æ‰£ç¨ (0% / 10%)</span><span class="val" id="wdTaxWHT">RM 0.00</span></div>
        <div class="tax-row total-row"><span class="label">å®é™…åˆ°è´¦</span><span class="val" id="wdTaxNet">RM 0.00</span></div>
      </div>
      <div class="notice notice-warn">âš ï¸ å¤„ç†æ—¶é—´ï¼š1-3 ä¸ªå·¥ä½œæ—¥ã€‚å¹³å°å°†ç”Ÿæˆæ‰£ç¨å‡­è¯ä¾› LHDN æŠ¥ç¨ä½¿ç”¨ã€‚</div>
      <button class="btn btn-primary btn-full btn-lg" onclick="doWithdraw()">ç”³è¯·ææ¬¾</button>
    </div>
  </div>
</div>

<!-- ORDER DETAIL -->
<div class="overlay" id="orderDetailModal" onclick="if(e(event))closeM('orderDetailModal')">
  <div class="modal" style="max-width:620px">
    <div class="modal-hd"><h2>ğŸ“¦ è®¢å•è¯¦æƒ…</h2><button class="modal-close" onclick="closeM('orderDetailModal')">âœ•</button></div>
    <div class="modal-body" id="orderDetailBody"></div>
  </div>
</div>

<!-- REVIEW -->
<div class="overlay" id="reviewModal" onclick="if(e(event))closeM('reviewModal')">
  <div class="modal" style="max-width:440px">
    <div class="modal-hd"><h2>â­ è¯„ä»·è®¢å•</h2><button class="modal-close" onclick="closeM('reviewModal')">âœ•</button></div>
    <div class="modal-body">
      <div style="text-align:center;margin-bottom:16px">
        <div style="font-size:.85rem;color:var(--muted);margin-bottom:10px">æ‚¨å¯¹æœ¬æ¬¡æœåŠ¡çš„æ»¡æ„åº¦</div>
        <div id="starRow" style="font-size:2.2rem;cursor:pointer;letter-spacing:4px">
          <span onclick="setRating(1)">â˜†</span><span onclick="setRating(2)">â˜†</span><span onclick="setRating(3)">â˜†</span><span onclick="setRating(4)">â˜†</span><span onclick="setRating(5)">â˜†</span>
        </div>
        <div id="ratingLabel" style="font-size:.8rem;color:var(--muted);margin-top:6px">è¯·é€‰æ‹©è¯„åˆ†</div>
      </div>
      <div class="form-group"><label class="form-label">æ²Ÿé€š</label><div id="subRate1" style="font-size:1.5rem;cursor:pointer;letter-spacing:3px"><span onclick="setSub(1,1)">â˜†</span><span onclick="setSub(1,2)">â˜†</span><span onclick="setSub(1,3)">â˜†</span><span onclick="setSub(1,4)">â˜†</span><span onclick="setSub(1,5)">â˜†</span></div></div>
      <div class="form-group"><label class="form-label">æœåŠ¡è´¨é‡</label><div id="subRate2" style="font-size:1.5rem;cursor:pointer;letter-spacing:3px"><span onclick="setSub(2,1)">â˜†</span><span onclick="setSub(2,2)">â˜†</span><span onclick="setSub(2,3)">â˜†</span><span onclick="setSub(2,4)">â˜†</span><span onclick="setSub(2,5)">â˜†</span></div></div>
      <div class="form-group"><label class="form-label">æŒ‰æ—¶äº¤ä»˜</label><div id="subRate3" style="font-size:1.5rem;cursor:pointer;letter-spacing:3px"><span onclick="setSub(3,1)">â˜†</span><span onclick="setSub(3,2)">â˜†</span><span onclick="setSub(3,3)">â˜†</span><span onclick="setSub(3,4)">â˜†</span><span onclick="setSub(3,5)">â˜†</span></div></div>
      <div class="form-group"><label class="form-label">è¯„ä»·å†…å®¹</label><textarea class="form-input" id="revTxt" placeholder="åˆ†äº«æ‚¨çš„è´­ä¹°ä½“éªŒï¼Œå¸®åŠ©å…¶ä»–ä¹°å®¶åšå†³å®šâ€¦"></textarea></div>
      <button class="btn btn-primary btn-full btn-lg" onclick="submitReview()">æäº¤è¯„ä»·</button>
    </div>
  </div>
</div>

<!-- DISPUTE -->
<div class="overlay" id="disputeModal" onclick="if(e(event))closeM('disputeModal')">
  <div class="modal" style="max-width:520px">
    <div class="modal-hd"><h2>âš–ï¸ æäº¤çº çº·</h2><button class="modal-close" onclick="closeM('disputeModal')">âœ•</button></div>
    <div class="modal-body">
      <div class="notice notice-warn">âš ï¸ æäº¤çº çº·åï¼Œå¹³å°å°†å†»ç»“ç›¸å…³èµ„é‡‘å¹¶åœ¨ 5 ä¸ªå·¥ä½œæ—¥å†…å¤„ç†ã€‚è¯·æä¾›å……åˆ†è¯æ®ã€‚</div>
      <div class="form-group"><label class="form-label">çº çº·åŸå› </label>
        <select class="form-input"><option>å–å®¶æœªæŒ‰æ—¶äº¤ä»˜</option><option>æœåŠ¡è´¨é‡ä¸ç¬¦åˆæè¿°</option><option>å–å®¶æ— å“åº”ï¼ˆè¶…48å°æ—¶ï¼‰</option><option>è´¦å·/èµ„äº§å—æŸ</option><option>å…¶ä»–</option></select>
      </div>
      <div class="form-group"><label class="form-label">è¯¦ç»†è¯´æ˜</label><textarea class="form-input" style="min-height:110px" placeholder="è¯·è¯¦ç»†æè¿°é—®é¢˜ï¼ŒåŒ…æ‹¬æ—¶é—´ã€æ²Ÿé€šè®°å½•ç­‰â€¦"></textarea></div>
      <div class="form-group"><label class="form-label">æœŸæœ›è§£å†³æ–¹å¼</label>
        <div style="display:flex;gap:8px;flex-wrap:wrap">
          <div class="pm-opt active" style="flex:none;padding:8px 14px">ğŸ’° å…¨é¢é€€æ¬¾</div>
          <div class="pm-opt" style="flex:none;padding:8px 14px">ğŸ”„ é‡æ–°äº¤ä»˜</div>
          <div class="pm-opt" style="flex:none;padding:8px 14px">ğŸ’¸ éƒ¨åˆ†é€€æ¬¾</div>
        </div>
      </div>
      <button class="btn btn-danger btn-full btn-lg" onclick="submitDispute()">æäº¤çº çº·ç”³è¯·</button>
    </div>
  </div>
</div>

<!-- EDIT PROFILE -->
<div class="overlay" id="editProfModal" onclick="if(e(event))closeM('editProfModal')">
  <div class="modal" style="max-width:500px">
    <div class="modal-hd"><h2>âœï¸ ç¼–è¾‘èµ„æ–™</h2><button class="modal-close" onclick="closeM('editProfModal')">âœ•</button></div>
    <div class="modal-body">
      <div class="form-group"><label class="form-label">æ˜¾ç¤ºåç§°</label><input class="form-input" id="epName"></div>
      <div class="form-group"><label class="form-label">ä¸ªäººç®€ä»‹</label><textarea class="form-input" id="epBio" placeholder="ä»‹ç»ä¸€ä¸‹è‡ªå·±â€¦"></textarea></div>
      <div class="form-group"><label class="form-label">æ‰€åœ¨åœ°</label><select class="form-input"><option>Kuala Lumpur</option><option>Selangor</option><option>Johor</option><option>Penang</option><option>Perak</option><option>Sabah</option><option>Sarawak</option><option>å…¶ä»–</option></select></div>
      <div class="form-group"><label class="form-label">è¯­è¨€</label><input class="form-input" placeholder="ä¸­æ–‡, English, BMâ€¦"></div>
      <div class="form-group"><label class="form-label">WhatsApp</label><input class="form-input" id="epWa" placeholder="+6012xxxxxxxx"></div>
      <button class="btn btn-primary btn-full" onclick="saveProfEdit()">ä¿å­˜æ›´æ”¹</button>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• FOOTER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<footer>
  <div class="wrap">
    <div class="foot-grid">
      <div class="foot-brand">
        <div style="display:flex;align-items:center;gap:10px;margin-bottom:6px">
          <div class="logo-icon" style="width:34px;height:34px;font-size:13px">NS</div>
          <span style="font-family:var(--font-display);font-weight:700">NovaServe</span>
        </div>
        <p>é©¬æ¥è¥¿äºšé¢†å…ˆçš„æ•°å­—è‡ªç”±èŒä¸šå¹³å°ã€‚æ”¯æŒ LHDN e-Invoice (MyInvois) ç³»ç»Ÿï¼Œå…¨é¢ SST åˆè§„ã€‚</p>
        <div style="margin-top:12px;display:flex;gap:8px;flex-wrap:wrap">
          <span style="font-size:.68rem;padding:3px 9px;border-radius:999px;background:rgba(251,146,60,.1);border:1px solid rgba(251,146,60,.2);color:var(--warn)">LHDN åˆè§„</span>
          <span style="font-size:.68rem;padding:3px 9px;border-radius:999px;background:rgba(110,255,212,.08);border:1px solid rgba(110,255,212,.15);color:var(--accent)">SST æ³¨å†Œ</span>
          <span style="font-size:.68rem;padding:3px 9px;border-radius:999px;background:rgba(56,189,248,.08);border:1px solid rgba(56,189,248,.15);color:var(--accent4)">MyInvois API</span>
          <span style="font-size:.68rem;padding:3px 9px;border-radius:999px;background:rgba(74,222,128,.08);border:1px solid rgba(74,222,128,.15);color:var(--success)">256-bit SSL</span>
        </div>
      </div>
      <div class="foot-col"><h4>æœåŠ¡åˆ†ç±»</h4><a>ğŸ® æ¸¸æˆä»£æ‰“</a><a>ğŸ’ æ¸¸æˆä»£å……</a><a>ğŸ’» ç¼–ç¨‹å¼€å‘</a><a>ğŸ¨ è®¾è®¡åˆ›ä½œ</a><a>ğŸ”® å åœè§£è¯»</a><a>ğŸ“ æ–‡æ¡ˆå†™ä½œ</a></div>
      <div class="foot-col"><h4>å…³äºå¹³å°</h4><a>å…³äº NovaServe</a><a>æœåŠ¡æ¡æ¬¾</a><a>éšç§æ”¿ç­–</a><a>åæ´—é’±æ”¿ç­–</a><a>å¸®åŠ©ä¸­å¿ƒ</a><a>è”ç³»æˆ‘ä»¬</a></div>
      <div class="foot-col"><h4>ç¨åŠ¡èµ„æº</h4><a onclick="openM('taxReportModal')">ğŸ“Š ç¨åŠ¡æŠ¥å‘Š</a><a onclick="openM('einvListModal')">ğŸ§¾ e-Invoice è®°å½•</a><a>LHDN MyInvois</a><a>SST æŒ‡å—</a><a>ä¸ªäººæ‰€å¾—ç¨ (BE)</a><a>ä¼ä¸šç¨ (C Form)</a></div>
    </div>
    <div class="foot-bottom">
      <p>Â© 2025 NovaServe Â· é©¬æ¥è¥¿äºšæ•°å­—è‡ªç”±èŒä¸šå¹³å° Â· SST æ³¨å†Œå·: W16-XXXX-XXXXXXXX Â· ROC: XXXXXXX-X</p>
      <div style="display:flex;align-items:center;gap:11px">
        <select class="lang-sel"><option>ğŸ‡²ğŸ‡¾ ä¸­æ–‡</option><option>ğŸ‡²ğŸ‡¾ BM</option><option>ğŸ‡ºğŸ‡¸ EN</option></select>
        <span style="font-size:.73rem;color:var(--muted2)">MYR (RM)</span>
      </div>
    </div>
  </div>
</footer>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DATA
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const GIGS=[
  {id:1,cat:'game',em:'ğŸ®',title:'MOBA æ’ä½ä»£æ‰“ï½œç‹è€…è£è€€ é’»çŸ³â†’ç‹è€… å®‰å…¨æ‰‹æ‰“',sel:'ProGamer_Ken',sav:'KN',lvl:'Pro',price:80,rating:4.9,rev:128,desc:'ä¸“ä¸šä»£æ‰“æœåŠ¡ï¼Œå®‰å…¨æ‰‹æ‰“ï¼Œæ®µä½ä¿éšœã€‚10å¹´ç»éªŒï¼ŒæœåŠ¡é©¬æ¥è¥¿äºš/æ–°åŠ å¡ã€‚å“åº”è¿…é€Ÿï¼Œ24å°æ—¶æœåŠ¡ã€‚',tags:['ç‹è€…è£è€€','ä»£æ‰“','æ’ä½','æ‰‹æ‰“','MOBA'],pkgs:[{n:'åŸºç¡€',p:80,d:1,r:2,f:['é’»ä¸€â†’é’»ä¸‰','æ‰‹åŠ¨æ“ä½œ','æ¯æ—¥æˆªå›¾æŠ¥å‘Š','âœ—è´¦å·ä¿æŠ¤é™©']},{n:'æ ‡å‡†',p:150,d:2,r:3,f:['é’»çŸ³â†’é“‚é‡‘','æ‰‹åŠ¨æ“ä½œ','å®æ—¶æˆªå›¾æŠ¥å‘Š','è´¦å·ä¿æŠ¤é™©']},{n:'é«˜çº§',p:280,d:5,r:'æ— é™',f:['é“‚é‡‘â†’ç‹è€…','æ‰‹åŠ¨æ“ä½œ','å®æ—¶æˆªå›¾æŠ¥å‘Š','è´¦å·ä¿æŠ¤é™©','ä¼˜å…ˆå¤„ç†','å”®å7å¤©']}]},
  {id:2,cat:'topup',em:'ğŸ’',title:'æ‰‹æ¸¸å……å€¼ä»£å……ï½œMLBB / Genshin / PUBG / FF å…¨å¹³å°å³æ—¶åˆ°è´¦',sel:'TopupKing_MY',sav:'TK',lvl:'Top',price:20,rating:5.0,rev:342,desc:'å³æ—¶å……å€¼ï¼Œæ¥å—DuitNowã€TNGã€Boostã€é“¶è¡Œè½¬è´¦ã€‚æ”¯æŒæ‰€æœ‰çƒ­é—¨æ‰‹æ¸¸ï¼Œ7Ã—24å°æ—¶æœåŠ¡ã€‚',tags:['å……å€¼','MLBB','åŸç¥','PUBG','Free Fire'],pkgs:[{n:'åŸºç¡€',p:20,d:0,r:0,f:['æœ€ä½RM20å……å€¼','å³æ—¶åˆ°è´¦','DuitNow/TNG','âœ—æŠ˜æ‰£']},{n:'æ ‡å‡†',p:100,d:0,r:0,f:['RM100ä»¥ä¸Š','3%æŠ˜æ‰£','å³æ—¶åˆ°è´¦','æ‰€æœ‰æ”¯ä»˜æ–¹å¼']},{n:'é«˜çº§',p:300,d:0,r:0,f:['RM300ä»¥ä¸Š','8%æŠ˜æ‰£','å³æ—¶åˆ°è´¦','ä¸“å±å®¢æœ','ä¼˜å…ˆå¤„ç†']}]},
  {id:3,cat:'code',em:'ğŸ’»',title:'Discord Bot å¼€å‘ | Python / JS å…¨åŠŸèƒ½æœºå™¨äºº + ç½‘ç«™',sel:'DevNova_ZX',sav:'DZ',lvl:'Pro',price:90,rating:4.8,rev:67,desc:'ä¸“ä¸šå…¨æ ˆå¼€å‘ï¼ŒDiscord Botã€ç½‘é¡µåº”ç”¨ã€Telegram Botã€è‡ªåŠ¨åŒ–è„šæœ¬ã€‚5å¹´ç»éªŒã€‚',tags:['Discord','Python','JavaScript','Bot','è‡ªåŠ¨åŒ–'],pkgs:[{n:'åŸºç¡€',p:90,d:3,r:2,f:['åŸºç¡€Bot 5å‘½ä»¤','æºç äº¤ä»˜','1æ¬¡ä¿®æ”¹','âœ—éƒ¨ç½²ååŠ©']},{n:'æ ‡å‡†',p:200,d:7,r:3,f:['è¿›é˜¶Bot 20å‘½ä»¤','æ•°æ®åº“é›†æˆ','æºç +éƒ¨ç½²','3æ¬¡ä¿®æ”¹']},{n:'é«˜çº§',p:450,d:14,r:'æ— é™',f:['å®Œæ•´ç³»ç»Ÿ','APIé›†æˆ','æºç +éƒ¨ç½²+ç»´æŠ¤1æœˆ','æ— é™ä¿®æ”¹','æŠ€æœ¯æ”¯æŒ']}]},
  {id:4,cat:'code',em:'ğŸ§ ',title:'React / Next.js ç³»ç»Ÿè®¾è®¡ + UI ä¼˜åŒ– å…¨æ ˆäº¤ä»˜',sel:'DevNova_ZX',sav:'DZ',lvl:'Pro',price:180,rating:4.9,rev:34,desc:'å¤æ‚å‰ç«¯é¡¹ç›®ã€ç³»ç»Ÿæ¶æ„è®¾è®¡ã€UI/UXä¼˜åŒ–ã€‚ç²¾é€š React/Next.js/TypeScriptã€‚',tags:['React','Next.js','UI','å‰ç«¯','TypeScript'],pkgs:[{n:'åŸºç¡€',p:180,d:5,r:2,f:['å•é¡µé¢ä¼˜åŒ–','ä»£ç å®¡æŸ¥','âœ—ç³»ç»Ÿè®¾è®¡']},{n:'æ ‡å‡†',p:380,d:10,r:3,f:['å¤šé¡µé¢é‡è®¾è®¡','æ€§èƒ½ä¼˜åŒ–','ç³»ç»Ÿè®¾è®¡æ–‡æ¡£']},{n:'é«˜çº§',p:750,d:21,r:'æ— é™',f:['å®Œæ•´é¡¹ç›®','ç³»ç»Ÿæ¶æ„','UIå…¨å¥—','æµ‹è¯•+éƒ¨ç½²']}]},
  {id:5,cat:'tarot',em:'ğŸ”®',title:'å¡”ç½—å åœ | æ„Ÿæƒ… / äº‹ä¸š / è´¢è¿ä¸‰æ–¹å‘è¯¦ç»†è§£è¯»',sel:'MysticLuna88',sav:'ML',lvl:'',price:30,rating:4.7,rev:89,desc:'ä¸“ä¸šå¡”ç½—ç‰Œè§£è¯»ï¼Œæ„Ÿæƒ…ã€äº‹ä¸šã€è´¢è¿ä¸‰æ–¹å‘ã€‚çœŸè¯šè§£è¯»ï¼Œä¸è¿·ä¿¡ï¼Œä»…ä¾›å‚è€ƒã€‚',tags:['å¡”ç½—ç‰Œ','å åœ','æ„Ÿæƒ…','äº‹ä¸š','è´¢è¿'],pkgs:[{n:'åŸºç¡€',p:30,d:1,r:1,f:['ä¸‰å¼ ç‰Œè§£è¯»','æ–‡å­—æŠ¥å‘Š','ä¸€ä¸ªæ–¹å‘','âœ—è¯­éŸ³']},{n:'æ ‡å‡†',p:65,d:1,r:2,f:['åå¼ ç‰Œå¤§é˜µ','è¯¦ç»†æŠ¥å‘Š','ä¸¤ä¸ªæ–¹å‘','ç…§ç‰‡ç‰Œé˜µ']},{n:'é«˜çº§',p:120,d:2,r:'æ— é™',f:['å‡¯å°”ç‰¹åå­—é˜µ','è¯­éŸ³è§£è¯»','ä¸‰ä¸ªæ–¹å‘','ç­”ç–‘æœåŠ¡']}]},
  {id:6,cat:'design',em:'ğŸ¨',title:'Logo è®¾è®¡ + å®Œæ•´å“ç‰Œè§†è§‰å¥—è£… çŸ¢é‡äº¤ä»˜',sel:'ArtStar_Lena',sav:'AL',lvl:'Top',price:60,rating:4.9,rev:156,desc:'ä¸“ä¸šå“ç‰Œè®¾è®¡ï¼Œç°ä»£ç®€æ´é£æ ¼ã€‚äº¤ä»˜çŸ¢é‡AI/EPS+æ‰€æœ‰æ ¼å¼ã€‚é©¬æ¥è¥¿äºšæœ¬åœ°è®¾è®¡å¸ˆã€‚',tags:['Logo','å“ç‰Œ','è®¾è®¡','çŸ¢é‡','Illustrator'],pkgs:[{n:'åŸºç¡€',p:60,d:3,r:2,f:['1ä¸ªLogoæ¦‚å¿µ','PNG/JPGæ ¼å¼','âœ—æºæ–‡ä»¶','âœ—å“ç‰Œæ‰‹å†Œ']},{n:'æ ‡å‡†',p:130,d:5,r:4,f:['3ä¸ªæ¦‚å¿µ','AI/EPSæºæ–‡ä»¶','ç®€å•å“ç‰Œæ‰‹å†Œ','åç‰‡è®¾è®¡']},{n:'é«˜çº§',p:280,d:10,r:'æ— é™',f:['5ä¸ªæ¦‚å¿µ','å®Œæ•´å“ç‰Œå¥—è£…','å“ç‰Œæ‰‹å†Œ','5ç§åº”ç”¨åœºæ™¯']}]},
  {id:7,cat:'design',em:'âœï¸',title:'UI/UX è®¾è®¡ Figma | ç§»åŠ¨ç«¯ App + ç½‘é¡µå…¨å¥—',sel:'ArtStar_Lena',sav:'AL',lvl:'Top',price:120,rating:4.8,rev:43,desc:'Figmaé«˜ä¿çœŸåŸå‹ï¼Œç§»åŠ¨ç«¯/ç½‘é¡µå‡å¯ã€‚äº¤ä»˜å®Œæ•´è®¾è®¡ç³»ç»Ÿ+å¯ç‚¹å‡»åŸå‹ã€‚',tags:['Figma','UI','UX','åŸå‹','ç§»åŠ¨ç«¯'],pkgs:[{n:'åŸºç¡€',p:120,d:5,r:2,f:['5ä¸ªç•Œé¢','Figmaæ–‡ä»¶','æ‰‹æœºç«¯','âœ—äº¤äº’åŸå‹']},{n:'æ ‡å‡†',p:250,d:10,r:3,f:['15ä¸ªç•Œé¢','å¯ç‚¹å‡»åŸå‹','æ‰‹æœº+å¹³æ¿','è®¾è®¡ç³»ç»Ÿ']},{n:'é«˜çº§',p:480,d:21,r:'æ— é™',f:['å®Œæ•´App UI','äº¤äº’åŸå‹','è®¾è®¡ç³»ç»Ÿ','å›¾æ ‡+æ’ç”»']}]},
  {id:8,cat:'writing',em:'ğŸ“',title:'SEO ä¼˜åŒ–æ–‡ç«  + äº§å“æ–‡æ¡ˆ ä¸­è‹±åŒè¯­ä¸“ä¸šå†™ä½œ',sel:'WordCraft_Amy',sav:'WA',lvl:'',price:45,rating:4.6,rev:72,desc:'ä¸“ä¸šä¸­è‹±æ–‡æ–‡æ¡ˆå†™ä½œï¼ŒSEOä¼˜åŒ–ï¼Œç”µå•†äº§å“æè¿°ã€åšå®¢æ–‡ç« ã€å•†ä¸šææ¡ˆã€‚',tags:['æ–‡æ¡ˆ','SEO','å†™ä½œ','åšå®¢','ç”µå•†'],pkgs:[{n:'åŸºç¡€',p:45,d:2,r:2,f:['500å­—æ–‡ç« ','SEOä¼˜åŒ–','1ä¸ªå…³é”®è¯','âœ—é…å›¾']},{n:'æ ‡å‡†',p:95,d:3,r:3,f:['1500å­—','SEOä¼˜åŒ–','5ä¸ªå…³é”®è¯','é…å›¾æ¨è']},{n:'é«˜çº§',p:180,d:5,r:'æ— é™',f:['3000å­—','å®Œæ•´SEO','10ä¸ªå…³é”®è¯','é…å›¾+æ’ç‰ˆ']}]},
];

const SELLERS=[
  {n:'ProGamer_Ken',av:'KN',title:'èŒä¸šæ¸¸æˆä»£æ‰“æ‰‹',badge:'pro',rating:4.9,orders:128,resp:'1å°æ—¶',em:'ğŸ®'},
  {n:'TopupKing_MY',av:'TK',title:'æ‰‹æ¸¸å……å€¼ä¸“å®¶',badge:'top',rating:5.0,orders:342,resp:'<30åˆ†',em:'ğŸ’'},
  {n:'DevNova_ZX',av:'DZ',title:'å…¨æ ˆå¼€å‘å·¥ç¨‹å¸ˆ',badge:'pro',rating:4.8,orders:67,resp:'2å°æ—¶',em:'ğŸ’»'},
  {n:'ArtStar_Lena',av:'AL',title:'å“ç‰Œè®¾è®¡å¸ˆ',badge:'top',rating:4.9,orders:156,resp:'3å°æ—¶',em:'ğŸ¨'},
  {n:'MysticLuna88',av:'ML',title:'å¡”ç½—ç‰Œå åœå¸ˆ',badge:'',rating:4.7,orders:89,resp:'1å°æ—¶',em:'ğŸ”®'},
  {n:'WordCraft_Amy',av:'WA',title:'SEOæ–‡æ¡ˆå†™ä½œè€…',badge:'',rating:4.6,orders:72,resp:'4å°æ—¶',em:'ğŸ“'},
];

const SAMPLE_ORDERS=[
  {id:'NS-2025-001',gig:'MOBA æ’ä½ä»£æ‰“ï½œç‹è€…è£è€€',em:'ğŸ®',sel:'ProGamer_Ken',pkg:'æ ‡å‡†å¥—é¤',base:150,status:'active',date:'2025-01-15',ddl:'2025-01-17',einv:true,einvId:'MY-EINV-2025-001-A7F3'},
  {id:'NS-2025-002',gig:'Logo è®¾è®¡ + å“ç‰Œè§†è§‰å¥—è£…',em:'ğŸ¨',sel:'ArtStar_Lena',pkg:'é«˜çº§å¥—é¤',base:280,status:'review',date:'2025-01-10',ddl:'2025-01-20',einv:true,einvId:'MY-EINV-2025-002-B2D9'},
  {id:'NS-2025-003',gig:'å¡”ç½—å åœ | æ„Ÿæƒ…è§£è¯»',em:'ğŸ”®',sel:'MysticLuna88',pkg:'åŸºç¡€å¥—é¤',base:30,status:'complete',date:'2025-01-05',ddl:'2025-01-06',einv:false,einvId:null},
  {id:'NS-2025-004',gig:'Discord Bot å¼€å‘',em:'ğŸ’»',sel:'DevNova_ZX',pkg:'æ ‡å‡†å¥—é¤',base:200,status:'dispute',date:'2024-12-28',ddl:'2025-01-04',einv:true,einvId:'MY-EINV-2025-004-C1E5'},
];

const CHATS={
  'ğŸ›ï¸ å¹³å°å®¢æœ':[{me:false,t:'ğŸ‘‹ ä½ å¥½ï¼æ¬¢è¿æ¥åˆ° NovaServeï¼Œæœ‰ä»€ä¹ˆå¯ä»¥å¸®æ‚¨ï¼Ÿ'},{me:true,t:'ä½ å¥½ï¼Œè¯·é—®å¦‚ä½•ç”³è¯·é€€æ¬¾ï¼Ÿ'},{me:false,t:'æ”¶åˆ°ï¼è‹¥è®¢å•åœ¨3å¤©ç¡®è®¤æœŸå†…ï¼Œæ‚¨å¯åœ¨è®¢å•è¯¦æƒ…é¡µç‚¹å‡»"ç”³è¯·é€€æ¬¾"ã€‚å¦‚æœ‰çº çº·ï¼Œå¯æäº¤çº çº·ç”³è¯·ï¼Œæˆ‘ä»¬å°†åœ¨5ä¸ªå·¥ä½œæ—¥å†…å¤„ç†ã€‚'}],
  'ğŸ® ProGamer_Ken':[{me:false,t:'å—¨ï¼æˆ‘çœ‹åˆ°æ‚¨ä¸‹å•äº†ä»£æ‰“æœåŠ¡ï¼Œè¯·æä¾›æ¸¸æˆè´¦å·ä¿¡æ¯ï¼Œä»Šæ™š9ç‚¹å¼€å§‹ï¼'},{me:true,t:'å¥½çš„ï¼Œè´¦å·å·²é€šè¿‡è®¢å•ç³»ç»Ÿå‘é€'},{me:false,t:'âœ… æ”¶åˆ°ï¼å¼€å§‹æ—¶ä¼šæˆªå›¾é€šçŸ¥æ‚¨ï¼Œè¯·æ”¾å¿ƒã€‚'}],
  'ğŸ¨ ArtStar_Lena':[{me:false,t:'æ”¶åˆ°Logoè®¾è®¡è®¢å•ï¼è¯·é—®åå¥½å“ªç§è‰²ç³»å’Œé£æ ¼ï¼Ÿ'},{me:true,t:'æ·±è‰²ç³»ï¼Œç°ä»£ç®€æ´'},{me:false,t:'æ˜ç™½ï¼3å¤©å†…å‘åˆç¨¿ï¼Œå¦‚æœ‰å‚è€ƒå›¾éšæ—¶å‘æ¥ ğŸ˜Š'}],
  'ğŸ’» DevNova_ZX':[{me:false,t:'æ‚¨å¥½ï¼å…³äºBotå¼€å‘éœ€æ±‚ï¼Œèƒ½è¯¦ç»†è¯´æ˜åŠŸèƒ½å—ï¼Ÿæˆ‘ä¼šä¸ºæ‚¨é‡èº«å®šåˆ¶ã€‚'}],
};

// SST Tax Codes (Malaysia)
const TAX_CODES={sst8:'SR-08',sst0:'ZR',exempt:'ES',relief:'RS'};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const S={
  user:null,favs:[],cart:null,
  currentChat:'',currentRating:0,
  currentGig:null,currentPkg:0,
  orders:[...SAMPLE_ORDERS],
  pm:'fpx',fpxBank:'',
  role:'buyer',
  walletBal:1243.50,
  walletMonth:387.00,
  walletPending:150.00,
  walletTotal:8923.00,
  walletTax:124.30,
  earnings:[
    {dir:'in',title:'ProGamer_Ken ä»£æ‰“æœåŠ¡',meta:'è®¢å• NS-2025-001 Â· 2025-01-15',amt:142.50},
    {dir:'in',title:'MysticLuna88 å åœæœåŠ¡',meta:'è®¢å• NS-2025-003 Â· 2025-01-05',amt:28.50},
    {dir:'out',title:'ææ¬¾è‡³ Maybank',meta:'2024-12-20 Â· è´¦å· ****4523',amt:-500.00},
    {dir:'in',title:'ArtStar_Lena Logoè®¾è®¡',meta:'è®¢å• NS-2025-002 Â· 2025-01-10',amt:266.00},
  ],
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
window.onload=()=>{
  genStars();
  renderGigs('homeGigs',GIGS.slice(0,8));
  renderGigs('newGigs',[...GIGS].reverse().slice(0,4));
  renderSellers();
  renderOrders(S.orders);
  renderChatContacts();
  renderWallet();
  renderProfContent('overview');
  initCheckout();
  selPM(document.querySelector('.pm-opt'),'fpx');
  updateWithdrawCalc();
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STARS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function genStars(){
  const sb=document.getElementById('starsBg');
  for(let i=0;i<80;i++){
    const s=document.createElement('div');s.className='star';
    const sz=Math.random()*2+1;
    Object.assign(s.style,{width:sz+'px',height:sz+'px',left:Math.random()*100+'%',top:Math.random()*100+'%','--dur':(2+Math.random()*4)+'s','--delay':(Math.random()*5)+'s'});
    sb.appendChild(s);
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function nav(p){
  document.querySelectorAll('.page').forEach(el=>el.classList.remove('active'));
  const pg=document.getElementById('page-'+p);
  if(pg)pg.classList.add('active');
  document.querySelectorAll('.hdr-nav a').forEach(a=>a.classList.remove('active'));
  const na=document.getElementById('hn-'+p);
  if(na)na.classList.add('active');
  window.scrollTo({top:0,behavior:'smooth'});
  if(p==='orders')renderOrders(S.orders);
  if(p==='profile')renderProfContent('overview');
  if(p==='wallet')renderWallet();
  if(p==='checkout')updateCheckout();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// GIG RENDERING
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const CAT_GRAD={game:'rgba(110,255,212,.14),rgba(56,189,248,.06)',topup:'rgba(167,139,250,.14),rgba(244,114,182,.06)',code:'rgba(56,189,248,.14),rgba(110,255,212,.06)',design:'rgba(244,114,182,.14),rgba(167,139,250,.06)',tarot:'rgba(167,139,250,.18),rgba(244,114,182,.1)',writing:'rgba(251,191,36,.1),rgba(167,139,250,.06)',marketing:'rgba(110,255,212,.1),rgba(56,189,248,.08)',video:'rgba(244,114,182,.12),rgba(251,191,36,.08)'};
const CAT_LBL={game:'ğŸ® ä»£æ‰“',topup:'ğŸ’ ä»£å……',code:'ğŸ’» ç¼–ç¨‹',design:'ğŸ¨ è®¾è®¡',tarot:'ğŸ”® å åœ',writing:'ğŸ“ æ–‡æ¡ˆ',marketing:'ğŸ“£ è¥é”€',video:'ğŸ¬ è§†é¢‘'};

function renderGigs(cid,gigs){
  const c=document.getElementById(cid);if(!c)return;
  c.innerHTML=gigs.map(g=>`
    <div class="gig-card" onclick="openGig(${g.id})">
      <div class="gig-thumb" style="background:linear-gradient(135deg,${CAT_GRAD[g.cat]||CAT_GRAD.code})">
        <span style="font-size:3.5rem;position:relative;z-index:1">${g.em}</span>
        <span class="gig-badge">${CAT_LBL[g.cat]||g.cat}</span>
        <span class="gig-fav${S.favs.includes(g.id)?' on':''}" onclick="event.stopPropagation();toggleFav(${g.id},this)">${S.favs.includes(g.id)?'â¤ï¸':'ğŸ¤'}</span>
      </div>
      <div class="gig-body">
        <div class="gig-seller-row">
          <div class="s-av">${g.sav}</div>
          <span class="s-name">${g.sel}</span>
          ${g.lvl?`<span class="s-lvl">${g.lvl}</span>`:''}
        </div>
        <div class="gig-title">${g.title}</div>
        <div class="gig-foot">
          <div class="g-rating">â˜… ${g.rating} <span style="color:var(--muted)">(${g.rev})</span></div>
          <div class="g-price"><small>èµ·ä»· </small>RM ${g.price}</div>
        </div>
      </div>
    </div>`).join('');
}

function toggleFav(id,el){
  if(S.favs.includes(id)){S.favs=S.favs.filter(f=>f!==id);el.textContent='ğŸ¤';el.classList.remove('on');showToast('å·²å–æ¶ˆæ”¶è—','info');}
  else{S.favs.push(id);el.textContent='â¤ï¸';el.classList.add('on');showToast('å·²åŠ å…¥æ”¶è— â¤ï¸','success');}
}

function renderSellers(){
  const c=document.getElementById('homeSellers');if(!c)return;
  c.innerHTML=SELLERS.map(s=>`
    <div class="seller-card">
      <div class="sc-av">${s.em}</div>
      ${s.badge==='pro'?'<span class="badge-pro">PRO</span>':s.badge==='top'?'<span class="badge-top">TOP â˜…</span>':''}
      <div class="sc-name">${s.n}</div>
      <div class="sc-title">${s.title}</div>
      <div class="sc-stats">
        <div class="sc-stat"><strong>â˜… ${s.rating}</strong>è¯„åˆ†</div>
        <div class="sc-stat"><strong>${s.orders}</strong>è®¢å•</div>
        <div class="sc-stat"><strong>${s.resp}</strong>å›å¤</div>
      </div>
    </div>`).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// GIG DETAIL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openGig(id){
  const g=GIGS.find(x=>x.id===id);if(!g)return;
  S.currentGig=g;S.currentPkg=0;
  document.getElementById('gmTitle').textContent=g.title;
  document.getElementById('gmBody').innerHTML=buildGigDetail(g);
  openM('gigModal');
}

function buildGigDetail(g){
  return`<div class="gd-grid">
    <div>
      <div class="gd-img" style="background:linear-gradient(135deg,${CAT_GRAD[g.cat]||CAT_GRAD.code})">${g.em}</div>
      <div class="gd-title">${g.title}</div>
      <div class="gig-seller-row" style="margin-bottom:12px">
        <div class="s-av">${g.sav}</div>
        <strong>${g.sel}</strong>${g.lvl?`<span class="s-lvl">${g.lvl}</span>`:''}
        <span class="g-rating" style="margin-left:8px">â˜… ${g.rating} (${g.rev}æ¡è¯„ä»·)</span>
      </div>
      <div class="tag-row">${g.tags.map(t=>`<span class="tag">${t}</span>`).join('')}</div>
      <div class="gd-desc">${g.desc}</div>
      <div class="reviews"><h3 style="font-family:var(--font-display);margin-bottom:12px">ä¹°å®¶è¯„ä»·</h3>${buildSampleReviews()}</div>
    </div>
    <div>
      <div class="pkg-tabs" id="pkgTabs">${g.pkgs.map((p,i)=>`<div class="pkg-tab${i===0?' active':''}" onclick="switchPkg(${i})">${p.n}</div>`).join('')}</div>
      <div class="pkg-box" id="pkgBox">${buildPkg(g,0)}</div>
      <div class="si-card">
        <div class="si-top"><div class="si-av">${g.em}</div><div><div class="si-name">${g.sel}</div><div class="si-meta">ğŸŸ¢ åœ¨çº¿ Â· å›å¤ &lt;1å°æ—¶</div></div></div>
        <div class="si-stats-grid">
          <div class="si-stat-box"><strong>${g.rev}</strong><small>å®Œæˆè®¢å•</small></div>
          <div class="si-stat-box"><strong>â˜… ${g.rating}</strong><small>å¹³å‡è¯„åˆ†</small></div>
          <div class="si-stat-box"><strong>98%</strong><small>æŒ‰æ—¶äº¤ä»˜</small></div>
          <div class="si-stat-box"><strong>100%</strong><small>å›å¤ç‡</small></div>
        </div>
        <button class="btn btn-secondary btn-full" onclick="contactSeller('${g.sel}')">ğŸ’¬ è”ç³»å–å®¶</button>
      </div>
    </div>
  </div>`;
}

function buildPkg(g,idx){
  const p=g.pkgs[idx];
  const fee=p.p*0.05;const sst=p.p*0.08;const total=p.p+fee+sst;
  return`<div class="pkg-price">RM ${p.p}</div>
  <div class="pkg-meta"><span>â± ${p.d>0?p.d+'å¤©äº¤ä»˜':'å³æ—¶äº¤ä»˜'}</span><span>ğŸ”„ ä¿®æ”¹${p.r}æ¬¡</span></div>
  <ul class="pkg-feat-list">${p.f.map(f=>`<li><span class="${f.startsWith('âœ—')?'xchk':'chk'}">${f.startsWith('âœ—')?'âœ•':'âœ“'}</span> ${f.replace('âœ—','')}</li>`).join('')}</ul>
  <div style="background:rgba(110,255,212,.04);border:1px solid rgba(110,255,212,.1);border-radius:9px;padding:10px 14px;margin-bottom:14px;font-size:.77rem">
    <div style="display:flex;justify-content:space-between;margin-bottom:4px"><span style="color:var(--muted)">æœåŠ¡è´¹</span><span style="font-family:var(--font-mono)">RM ${p.p.toFixed(2)}</span></div>
    <div style="display:flex;justify-content:space-between;margin-bottom:4px"><span style="color:var(--muted)">å¹³å°è´¹ 5%</span><span style="font-family:var(--font-mono)">RM ${fee.toFixed(2)}</span></div>
    <div style="display:flex;justify-content:space-between;margin-bottom:4px"><span style="color:var(--muted)">SST 8%</span><span style="font-family:var(--font-mono)">RM ${sst.toFixed(2)}</span></div>
    <div style="display:flex;justify-content:space-between;font-weight:700;color:var(--accent)"><span>åˆè®¡</span><span style="font-family:var(--font-mono)">RM ${total.toFixed(2)}</span></div>
  </div>
  <button class="btn btn-primary btn-full btn-lg" onclick="proceedCheckout(${g.id},${idx})">ç«‹å³ä¸‹å• â†’</button>
  <button class="btn btn-secondary btn-full" style="margin-top:7px" onclick="addCart(${g.id},${idx})">ğŸ›’ åŠ å…¥è´­ç‰©è½¦</button>`;
}

function buildSampleReviews(){
  return[{u:'Jason_KL',r:5,t:'éå¸¸ä¸“ä¸šï¼æŒ‰æ—¶å®Œæˆï¼Œç»“æœè¶…å‡ºé¢„æœŸã€‚ç¬¬äºŒæ¬¡åˆä½œäº†ï¼Œå¼ºçƒˆæ¨èï¼',d:'2å¤©å‰'},{u:'Mei_Ling',r:5,t:'æ²Ÿé€šæµç•…ï¼Œè´¨é‡å¾ˆå¥½ã€‚ä¼šç»§ç»­æ”¯æŒï¼',d:'5å¤©å‰'},{u:'Ahmad_R',r:4,t:'æ•´ä½“æ»¡æ„ï¼Œæ²Ÿé€šç¨æ…¢ä½†ç»“æœä¸é”™ã€‚',d:'1å‘¨å‰'}].map(r=>`
    <div class="rev-item">
      <div class="rev-top"><div class="rev-av">${r.u[0]}</div><div><div class="rev-name">${r.u}</div><div class="stars">${'â˜…'.repeat(r.r)}${'â˜†'.repeat(5-r.r)}</div></div><div class="rev-date">${r.d}</div></div>
      <div class="rev-txt">${r.t}</div>
    </div>`).join('');
}

function switchPkg(idx){
  S.currentPkg=idx;
  document.querySelectorAll('.pkg-tab').forEach((t,i)=>t.classList.toggle('active',i===idx));
  document.getElementById('pkgBox').innerHTML=buildPkg(S.currentGig,idx);
}

function proceedCheckout(gid,pidx){
  if(!S.user){closeM('gigModal');openM('loginModal');showToast('è¯·å…ˆç™»å½•åå†ä¸‹å•','info');return;}
  const g=GIGS.find(x=>x.id===gid);
  S.cart={gig:g,pkg:g.pkgs[pidx],pidx};
  closeM('gigModal');updateCheckout();nav('checkout');
}

function addCart(gid,pidx){
  if(!S.user){openM('loginModal');showToast('è¯·å…ˆç™»å½•','info');return;}
  const g=GIGS.find(x=>x.id===gid);
  S.cart={gig:g,pkg:g.pkgs[pidx],pidx};
  document.getElementById('hdrCart').style.display='flex';
  document.getElementById('cartDot').style.display='block';
  showToast('å·²åŠ å…¥è´­ç‰©è½¦ ğŸ›’','success');closeM('gigModal');
}

function contactSeller(sel){
  closeM('gigModal');
  const key='ğŸ® '+sel;
  if(!CHATS[key])CHATS[key]=[{me:false,t:`æ‚¨å¥½ï¼æˆ‘æ˜¯ ${sel}ï¼Œæœ‰ä»€ä¹ˆå¯ä»¥å¸®æ‚¨çš„ï¼Ÿ`}];
  S.currentChat=key;nav('chat');setTimeout(()=>openChat(key),100);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CHECKOUT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function initCheckout(){
  const pmEl=document.querySelector('.pm-opt');if(pmEl)selPM(pmEl,'fpx');
}

function updateCheckout(){
  if(!S.cart)return;
  const {gig,pkg}=S.cart;
  document.getElementById('coGigInfo').innerHTML=`
    <div class="os-gig" style="margin-bottom:0">
      <div class="os-gig-emoji">${gig.em}</div>
      <div><div class="os-gig-title">${gig.title}</div><div class="os-gig-meta">${pkg.n}å¥—é¤ Â· å–å®¶: ${gig.sel}</div></div>
    </div>`;
  const buyerName=document.getElementById('buyerName');
  if(buyerName&&!buyerName.value&&S.user)buyerName.value=S.user.name;
  const buyerEmail=document.getElementById('buyerEmail');
  if(buyerEmail&&!buyerEmail.value&&S.user)buyerEmail.value=S.user.email||'';
  updateTaxCalc();
}

function updateTaxCalc(){
  if(!S.cart)return;
  const base=S.cart.pkg.p;
  const fee=base*0.05;
  const sst=base*0.08;
  const wht=0;
  const stamp=base>=500?10:0;
  const total=base+fee+sst+wht+stamp;
  const tax=sst+wht+stamp;
  setText('taxBase','RM '+base.toFixed(2));
  setText('taxFee','RM '+fee.toFixed(2));
  setText('taxSST','RM '+sst.toFixed(2));
  setText('taxWHT','RM '+wht.toFixed(2));
  setText('taxStamp',stamp>0?'RM '+stamp.toFixed(2):'RM 0.00 (å…é™¤)');
  setText('taxTotal','RM '+total.toFixed(2));
  setText('sumBase2','RM '+base.toFixed(2));
  setText('sumFee2','RM '+fee.toFixed(2));
  setText('sumTax2','RM '+tax.toFixed(2));
  setText('sumTotal2','RM '+total.toFixed(2));
  const einvNotice=document.getElementById('einvNotice');
  if(einvNotice)einvNotice.style.display=base>=200?'flex':'none';
  // Update summary gig
  const osg=document.getElementById('osSummaryGig');
  if(osg&&S.cart)osg.innerHTML=`<div class="os-gig-emoji">${S.cart.gig.em}</div><div><div class="os-gig-title">${S.cart.gig.title}</div><div class="os-gig-meta">${S.cart.pkg.n}å¥—é¤ Â· RM ${base}</div></div>`;
}

function selPM(el,pm){
  document.querySelectorAll('.pm-opt').forEach(b=>b.classList.remove('active'));
  el.classList.add('active');S.pm=pm;
  const d=document.getElementById('pmDetail');if(!d)return;
  const forms={
    fpx:`<h4>ğŸ¦ FPX ç½‘ä¸Šé“¶è¡Œ (Financial Process Exchange)</h4>
      <p style="font-size:.78rem;color:var(--muted);margin-bottom:12px">é©¬æ¥è¥¿äºšæœ€å¸¸ç”¨çš„ç½‘é“¶æ”¯ä»˜ç³»ç»Ÿï¼Œæ”¯æŒæ‰€æœ‰ä¸»è¦é“¶è¡Œã€‚</p>
      <div class="fpx-bank-grid" id="fpxBankGrid">
        ${['Maybank2U','CIMB Clicks','Public Bank','Hong Leong Connect','RHB Now','AmOnline','BSN Online','Bank Islam','Bank Rakyat','OCBC','Standard Chartered','UOB','Affin Online','Alliance Online','Bank Simpanan'].map(b=>`<div class="fpx-bank-btn" onclick="selFpx(this,'${b}')"><span class="bank-logo">ğŸ›ï¸</span>${b}</div>`).join('')}
      </div>`,
    duitnow:`<h4>ğŸ“² DuitNow QR / Transfer</h4>
      <p style="font-size:.78rem;color:var(--muted);margin-bottom:12px">æ‰«æ QR ç æ”¯ä»˜ï¼Œæˆ–ç›´æ¥ DuitNow è½¬è´¦è‡³ä»¥ä¸‹è´¦å·ã€‚</p>
      <div style="text-align:center;padding:16px">
        <div style="width:150px;height:150px;background:#fff;border-radius:12px;margin:0 auto 10px;display:flex;align-items:center;justify-content:center;font-size:.72rem;color:#333;font-family:var(--font-mono);text-align:center;padding:10px">
          [DuitNow QR]<br>æ‰«ææ”¯ä»˜<br>NovaServe
        </div>
        <div style="font-size:.8rem;color:var(--muted)">æˆ–è½¬è´¦è‡³ ID: <strong style="color:var(--text)">NovaServe@DuitNow</strong></div>
        <div class="form-group" style="margin-top:12px;text-align:left"><label class="form-label">æ‚¨çš„ DuitNow æ‰‹æœºå·ï¼ˆç”¨äºå¯¹è´¦ï¼‰</label><input class="form-input" placeholder="+6012xxxxxxxx"></div>
      </div>`,
    tng:`<h4>ğŸ’š Touch 'n Go eWallet</h4>
      <div class="input-2" style="display:grid;gap:11px;margin-top:10px">
        <div class="form-group"><label class="form-label">TNG ç»‘å®šæ‰‹æœºå·</label><input class="form-input" placeholder="+6012xxxxxxxx"></div>
        <div class="form-group"><label class="form-label">TNG ç”¨æˆ·åï¼ˆå¯é€‰ï¼‰</label><input class="form-input" placeholder="@tngusername"></div>
      </div>
      <p style="font-size:.76rem;color:var(--muted)">æ”¯ä»˜é“¾æ¥å°†å‘é€è‡³æ‚¨çš„æ‰‹æœºå·ã€‚TNG GO+ ä½™é¢åŒæ ·æ¥å—ã€‚</p>`,
    boost:`<h4>âš¡ Boost eWallet</h4>
      <div class="form-group" style="margin-top:10px"><label class="form-label">Boost æ‰‹æœºå·</label><input class="form-input" placeholder="+6012xxxxxxxx"></div>
      <p style="font-size:.76rem;color:var(--muted)">æ‚¨å°†æ”¶åˆ° Boost æ¨é€é€šçŸ¥è¿›è¡Œæ”¯ä»˜ç¡®è®¤ã€‚</p>`,
    grabpay:`<h4>ğŸš— GrabPay</h4>
      <div class="form-group" style="margin-top:10px"><label class="form-label">Grab è´¦å·é‚®ç®±</label><input class="form-input" type="email" placeholder="grab@email.com"></div>
      <p style="font-size:.76rem;color:var(--muted)">å°†å‘é€ GrabPay æ”¯ä»˜è¯·æ±‚è‡³æ‚¨çš„ Grab Appã€‚</p>`,
    shopeepay:`<h4>ğŸ› ShopeePay</h4>
      <div class="form-group" style="margin-top:10px"><label class="form-label">ShopeePay æ‰‹æœºå·</label><input class="form-input" placeholder="+6012xxxxxxxx"></div>`,
    visa:`<h4>ğŸ’³ ä¿¡ç”¨å¡ / å€Ÿè®°å¡ï¼ˆVisa / Mastercardï¼‰</h4>
      <div class="card-chip"><div class="chip-icon">CHIP</div><span class="card-network">Visa Â· Mastercard Â· Maestro</span></div>
      <div class="form-group"><label class="form-label">å¡å· <span class="req">*</span></label><input class="form-input card-num-input" id="ccNum" placeholder="0000  0000  0000  0000" maxlength="19" oninput="fmtCC(this)"></div>
      <div class="input-2" style="display:grid;gap:11px">
        <div class="form-group"><label class="form-label">æœ‰æ•ˆæœŸ <span class="req">*</span></label><input class="form-input" placeholder="MM / YY" maxlength="7" oninput="fmtExpiry(this)"></div>
        <div class="form-group"><label class="form-label">CVV <span class="req">*</span></label><input class="form-input" type="password" placeholder="â€¢â€¢â€¢" maxlength="4"></div>
      </div>
      <div class="form-group"><label class="form-label">æŒå¡äººå§“å <span class="req">*</span></label><input class="form-input" placeholder="å¦‚å¡é¢æ‰€ç¤ºå¤§å†™è‹±æ–‡å"></div>
      <div class="form-group"><label class="form-label">è´¦å•åœ°å€</label><input class="form-input" placeholder="è´¦å•é‚®ç¼– / åœ°å€ï¼ˆç”¨äº3DéªŒè¯ï¼‰"></div>
      <div class="notice notice-info" style="margin-top:10px">ğŸ”’ ç”± Stripe / iPay88 å¤„ç† Â· PCI-DSS Level 1 åˆè§„ Â· ä¸å­˜å‚¨å¡å·</div>`,
    amex:`<h4>ğŸ’  American Express</h4>
      <div class="form-group" style="margin-top:10px"><label class="form-label">Amex å¡å· <span class="req">*</span></label><input class="form-input card-num-input" placeholder="0000  000000  00000" maxlength="17"></div>
      <div class="input-2" style="display:grid;gap:11px">
        <div class="form-group"><label class="form-label">æœ‰æ•ˆæœŸ</label><input class="form-input" placeholder="MM / YY"></div>
        <div class="form-group"><label class="form-label">CIDï¼ˆ4ä½ï¼‰</label><input class="form-input" placeholder="â€¢â€¢â€¢â€¢" maxlength="4"></div>
      </div>
      <div class="form-group"><label class="form-label">æŒå¡äººå§“å</label><input class="form-input" placeholder="å¦‚å¡é¢æ‰€ç¤º"></div>`,
    crypto:`<h4>â‚¿ åŠ å¯†è´§å¸ USDT / BNB</h4>
      <div class="form-group" style="margin-top:10px"><label class="form-label">æ”¯ä»˜å¸ç§</label>
        <select class="form-input"><option>USDT (TRC20)</option><option>USDT (ERC20)</option><option>USDT (BEP20)</option><option>BNB (BEP20)</option></select>
      </div>
      <div style="background:var(--surface2);border-radius:10px;padding:14px;margin-bottom:12px">
        <div style="font-size:.77rem;color:var(--muted);margin-bottom:6px">å‘é€è‡³åœ°å€ï¼š</div>
        <div style="font-family:var(--font-mono);font-size:.78rem;word-break:break-all;color:var(--accent);border:1px solid var(--border);padding:8px;border-radius:7px;cursor:pointer" onclick="showToast('åœ°å€å·²å¤åˆ¶','success')">TRC20: TXXXxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</div>
      </div>
      <div class="notice notice-warn">âš ï¸ åŠ å¯†è´§å¸æ”¯ä»˜å e-Invoice ä»ä¼šç”Ÿæˆï¼ˆæŒ‰æ”¯ä»˜æ—¶æ±‡ç‡æ¢ç®— RMï¼‰ã€‚LHDN è§„å®šåŠ å¯†è´§å¸äº¤æ˜“é¡»ç”³æŠ¥ã€‚</div>`,
  };
  d.innerHTML=forms[pm]||'';
}

function selFpx(el,bank){
  document.querySelectorAll('.fpx-bank-btn').forEach(b=>b.classList.remove('active'));
  el.classList.add('active');S.fpxBank=bank;
}

function fmtCC(inp){let v=inp.value.replace(/\D/g,'');let f='';for(let i=0;i<v.length;i++){if(i>0&&i%4===0)f+='  ';f+=v[i]}inp.value=f;}
function fmtExpiry(inp){let v=inp.value.replace(/\D/g,'');if(v.length>=2)v=v.slice(0,2)+' / '+v.slice(2);inp.value=v;}

function placeOrder(){
  if(!S.user){openM('loginModal');showToast('è¯·å…ˆç™»å½•','info');return;}
  if(!S.cart){showToast('è¯·å…ˆé€‰æ‹©æœåŠ¡','error');return;}
  const req=document.getElementById('coReq');
  if(!req||!req.value.trim()){showToast('è¯·å¡«å†™è®¢å•éœ€æ±‚è¯´æ˜','error');return;}
  const email=document.getElementById('buyerEmail');
  if(!email||!email.value.trim()){showToast('è¯·å¡«å†™é‚®ç®±ï¼ˆç”¨äºæ¥æ”¶æ”¶æ®ï¼‰','error');return;}
  const {gig,pkg}=S.cart;
  const base=pkg.p;
  const total=base*1.13+( base>=500?10:0);
  const einvId='MY-EINV-2025-'+String(S.orders.length+100).padStart(3,'0')+'-'+Math.random().toString(36).substr(2,4).toUpperCase();
  const ord={
    id:'NS-2025-'+String(S.orders.length+100+1).padStart(3,'0'),
    gig:gig.title,em:gig.em,sel:gig.sel,pkg:pkg.n+'å¥—é¤',base,
    status:'active',date:new Date().toISOString().split('T')[0],
    ddl:new Date(Date.now()+Math.max(pkg.d,1)*86400000).toISOString().split('T')[0],
    einv:base>=200,einvId:base>=200?einvId:null,
    total,pm:S.pm,req:req.value,
    buyerEmail:email.value,
  };
  S.orders.unshift(ord);
  S.cart=null;
  document.getElementById('hdrCart').style.display='flex';
  document.getElementById('cartDot').style.display='none';
  if(S.pm==='fpx'&&S.fpxBank){showToast('æ­£åœ¨è·³è½¬è‡³ '+S.fpxBank+' è¿›è¡Œä»˜æ¬¾â€¦','info');setTimeout(()=>showToast('æ”¯ä»˜æˆåŠŸï¼è®¢å•å·²ç¡®è®¤ âœ…','success'),2000);}
  else if(S.pm==='visa'||S.pm==='amex'){showToast('æ­£åœ¨è¿›è¡Œ 3D Secure éªŒè¯â€¦','info');setTimeout(()=>showToast('æ”¯ä»˜æˆåŠŸï¼å¡ç‰‡ä»˜æ¬¾å·²ç¡®è®¤ âœ…','success'),1800);}
  else{showToast('æ”¯ä»˜è¯·æ±‚å·²å‘é€ ğŸ“²','info');setTimeout(()=>showToast('æ”¯ä»˜æˆåŠŸï¼è®¢å•å·²ç¡®è®¤ âœ…','success'),1500);}
  if(ord.einv){setTimeout(()=>{showToast('ğŸ“„ e-Invoice å·²ç”Ÿæˆï¼š'+ord.einvId,'info');},3000);}
  req.value='';
  nav('orders');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ORDERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderOrders(orders){
  const c=document.getElementById('ordersList');
  const emp=document.getElementById('ordersEmpty');
  if(!S.user||!orders.length){c.innerHTML='';if(emp)emp.style.display='block';return;}
  if(emp)emp.style.display='none';
  const labels={active:'è¿›è¡Œä¸­',review:'å¾…ç¡®è®¤',complete:'å·²å®Œæˆ',cancel:'å·²å–æ¶ˆ',dispute:'çº çº·å¤„ç†'};
  const cls={active:'sp-active',review:'sp-review',complete:'sp-complete',cancel:'sp-cancel',dispute:'sp-dispute'};
  c.innerHTML=orders.map(o=>`
    <div class="order-card" onclick="viewOrder('${o.id}')">
      <div class="oc-thumb">${o.em}</div>
      <div class="oc-info">
        <div class="oc-title">${o.gig}</div>
        <div class="oc-meta">å–å®¶: ${o.sel} Â· ${o.pkg} Â· ä¸‹å•: ${o.date} Â· æˆªæ­¢: ${o.ddl}</div>
        ${o.einv?`<div style="margin-top:5px;font-size:.7rem;color:var(--warn)">ğŸ§¾ e-Invoice: ${o.einvId}</div>`:''}
      </div>
      <div class="oc-right">
        <span class="status-pill ${cls[o.status]||'sp-active'}">${labels[o.status]||o.status}</span>
        <span style="font-family:var(--font-mono);font-weight:700;font-size:.9rem;color:var(--accent)">RM ${(o.base*1.13+(o.base>=500?10:0)).toFixed(2)}</span>
        ${o.status==='review'?`<button class="btn btn-primary btn-sm" onclick="event.stopPropagation();acceptOrder('${o.id}')">âœ“ ç¡®è®¤å®Œæˆ</button>`:''}
        ${o.status==='complete'?`<button class="btn btn-secondary btn-sm" onclick="event.stopPropagation();openM('reviewModal')">â­ è¯„ä»·</button>`:''}
        ${o.status==='active'?`<button class="btn btn-danger btn-sm" onclick="event.stopPropagation();openM('disputeModal')">âš–ï¸ çº çº·</button>`:''}
        ${o.einv?`<button class="btn btn-secondary btn-sm" onclick="event.stopPropagation();viewEinv('${o.id}')">ğŸ§¾ e-Invoice</button>`:''}
      </div>
    </div>`).join('');
}

function filterOrders(status,el){
  document.querySelectorAll('.order-tab').forEach(t=>t.classList.remove('active'));
  el.classList.add('active');
  renderOrders(status==='all'?S.orders:S.orders.filter(o=>o.status===status));
}

function acceptOrder(id){
  const o=S.orders.find(x=>x.id===id);
  if(o){o.status='complete';renderOrders(S.orders);showToast('âœ… å·²ç¡®è®¤å®Œæˆï¼Œæ¬¾é¡¹å·²é‡Šæ”¾ç»™å–å®¶','success');}
}

function viewOrder(id){
  const o=S.orders.find(x=>x.id===id);if(!o)return;
  const body=document.getElementById('orderDetailBody');
  body.innerHTML=`
    <div style="display:flex;gap:14px;padding:14px;background:var(--surface2);border-radius:11px;margin-bottom:18px">
      <span style="font-size:2.5rem">${o.em}</span>
      <div><div style="font-weight:600;margin-bottom:4px">${o.gig}</div><div style="font-size:.8rem;color:var(--muted)">${o.pkg} Â· å–å®¶: ${o.sel}</div></div>
    </div>
    <table class="einv-info-table" style="margin-bottom:18px">
      <tr><td>è®¢å•å·</td><td>${o.id}</td></tr>
      <tr><td>ä¸‹å•æ—¥æœŸ</td><td>${o.date}</td></tr>
      <tr><td>æˆªæ­¢æ—¥æœŸ</td><td>${o.ddl}</td></tr>
      <tr><td>æ”¯ä»˜çŠ¶æ€</td><td>âœ… å·²æ”¯ä»˜</td></tr>
      <tr><td>é‡‘é¢</td><td>RM ${(o.base*1.13+(o.base>=500?10:0)).toFixed(2)}</td></tr>
      ${o.einv?`<tr><td>e-Invoice</td><td style="color:var(--warn)">${o.einvId}</td></tr>`:''}
    </table>
    <div style="display:flex;gap:8px;flex-wrap:wrap">
      ${o.einv?`<button class="btn btn-secondary btn-sm" onclick="closeM('orderDetailModal');viewEinv('${o.id}')">ğŸ§¾ æŸ¥çœ‹ e-Invoice</button>`:''}
      <button class="btn btn-secondary btn-sm" onclick="closeM('orderDetailModal');openM('reviewModal')">ğŸ’¬ è”ç³»å–å®¶</button>
      ${o.status==='active'?`<button class="btn btn-danger btn-sm" onclick="closeM('orderDetailModal');openM('disputeModal')">âš–ï¸ æäº¤çº çº·</button>`:''}
    </div>`;
  openM('orderDetailModal');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// e-INVOICE (LHDN MyInvois)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function viewEinv(orderId){
  const o=S.orders.find(x=>x.id===orderId);if(!o||!o.einv)return;
  const fee=o.base*0.05;const sst=o.base*0.08;const stamp=o.base>=500?10:0;const total=o.base+fee+sst+stamp;
  const doc=document.getElementById('einvBody');
  doc.innerHTML=`
    <div class="lhdn-badge">ğŸ›ï¸ LHDN MyInvois åˆè§„ e-Invoice Â· ${TAX_CODES.sst8}</div>
    <div style="text-align:center;margin-bottom:18px">
      <div class="einv-qr">[QR Code]<br>UUID:<br>${o.einvId}<br><br>æ‰«æéªŒè¯</div>
      <div style="font-size:.72rem;color:var(--muted)">åœ¨ MyInvois Portal éªŒè¯æ­¤å‘ç¥¨</div>
    </div>
    <div style="background:var(--surface2);border-radius:11px;padding:16px;margin-bottom:16px">
      <div style="display:flex;justify-content:space-between;margin-bottom:12px">
        <div><div style="font-family:var(--font-display);font-weight:700;font-size:1.1rem">NovaServe</div><div style="font-size:.75rem;color:var(--muted)">SST Reg No: W16-XXXX-XXXXXXXX<br>ROC: XXXXXXX-X<br>TIN: CXXXXXXXXXX<br>No. xxx, Jalan xxx, 50000 Kuala Lumpur</div></div>
        <div style="text-align:right"><div style="font-family:var(--font-display);font-weight:700;color:var(--accent)">e-Invoice</div><div style="font-size:.75rem;color:var(--muted)">Invoice No: ${o.einvId}<br>Date: ${o.date}<br>Type: 01 - Invoice</div></div>
      </div>
    </div>
    <table class="einv-info-table" style="margin-bottom:16px">
      <tr><td>ä¹°å®¶</td><td>${S.user?S.user.name:'â€”'}</td></tr>
      <tr><td>NRIC</td><td>${S.user&&S.user.ic?S.user.ic:'â€”'}</td></tr>
      <tr><td>é‚®ç®±</td><td>${S.user&&S.user.email?S.user.email:'â€”'}</td></tr>
    </table>
    <table class="einv-info-table" style="margin-bottom:16px">
      <tr><td><strong>æœåŠ¡æè¿°</strong></td><td><strong>é‡‘é¢</strong></td></tr>
      <tr><td>${o.gig} (${o.pkg})</td><td>RM ${o.base.toFixed(2)}</td></tr>
      <tr><td>å¹³å°æœåŠ¡è´¹ (5%)</td><td>RM ${fee.toFixed(2)}</td></tr>
      <tr><td>SST 8% [SR-08]</td><td>RM ${sst.toFixed(2)}</td></tr>
      ${stamp>0?`<tr><td>å°èŠ±ç¨</td><td>RM ${stamp.toFixed(2)}</td></tr>`:''}
      <tr><td><strong>Total</strong></td><td><strong style="color:var(--accent)">RM ${total.toFixed(2)}</strong></td></tr>
    </table>
    <div class="notice notice-success" style="margin-bottom:14px">âœ… æ­¤ e-Invoice å·²æäº¤è‡³ LHDN MyInvois ç³»ç»Ÿå¹¶è·å¾—éªŒè¯ã€‚UUID: <span style="font-family:var(--font-mono);font-size:.78rem">${o.einvId}</span></div>
    <div style="display:flex;gap:8px;flex-wrap:wrap">
      <button class="btn btn-primary btn-sm" onclick="printEinv()">ğŸ–¨ï¸ æ‰“å° / ä¸‹è½½ PDF</button>
      <button class="btn btn-secondary btn-sm" onclick="showToast('å·²å‘é€è‡³é‚®ç®±','success')">ğŸ“§ å‘é€è‡³é‚®ç®±</button>
      <button class="btn btn-secondary btn-sm" onclick="window.open('https://myinvois.hasil.gov.my')">ğŸ›ï¸ MyInvois Portal</button>
    </div>`;
  openM('einvModal');
}

function printEinv(){window.print();showToast('æ­£åœ¨å‡†å¤‡æ‰“å°â€¦','info');}

function openEinvList(){
  const body=document.getElementById('einvListBody');
  const einvOrders=S.orders.filter(o=>o.einv);
  body.innerHTML=`
    <div class="notice notice-info" style="margin-bottom:14px">â„¹ï¸ ä»¥ä¸‹ä¸ºæœ¬è´¦å·æ‰€æœ‰ e-Invoice è®°å½•ã€‚å¯åœ¨ <a href="https://myinvois.hasil.gov.my" target="_blank" style="color:var(--accent)">LHDN MyInvois Portal</a> éªŒè¯ã€‚</div>
    ${einvOrders.length?einvOrders.map(o=>`
      <div style="display:flex;align-items:center;gap:12px;padding:13px;background:var(--surface2);border-radius:11px;margin-bottom:9px">
        <span style="font-size:1.8rem">${o.em}</span>
        <div style="flex:1">
          <div style="font-size:.85rem;font-weight:500">${o.gig}</div>
          <div style="font-size:.72rem;color:var(--warn);font-family:var(--font-mono)">${o.einvId}</div>
          <div style="font-size:.72rem;color:var(--muted)">${o.date} Â· RM ${(o.base*1.13).toFixed(2)}</div>
        </div>
        <button class="btn btn-secondary btn-sm" onclick="viewEinv('${o.id}');closeM('einvListModal')">æŸ¥çœ‹</button>
      </div>`).join(''):'<div style="text-align:center;padding:32px;color:var(--muted)">æš‚æ—  e-Invoice è®°å½•</div>'}
    <hr style="margin:18px 0">
    <div style="text-align:right"><button class="btn btn-primary btn-sm" onclick="openM('taxReportModal')">ğŸ“Š ç”Ÿæˆç¨åŠ¡æŠ¥å‘Š</button></div>`;
  openM('einvListModal');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TAX REPORT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openTaxReport(){
  const year=new Date().getFullYear();
  const einvOrders=S.orders.filter(o=>o.einv);
  const totalBase=einvOrders.reduce((s,o)=>s+o.base,0);
  const totalSST=totalBase*0.08;
  const totalFee=totalBase*0.05;
  const totalTotal=totalBase+totalSST+totalFee;
  document.getElementById('taxReportBody').innerHTML=`
    <div class="lhdn-badge" style="margin-bottom:14px">ğŸ›ï¸ LHDN å¹´åº¦ç¨åŠ¡æ‘˜è¦ Â· ${year}</div>
    <div class="wallet-card" style="margin-bottom:16px">
      <div class="wallet-label">æ€»äº¤æ˜“é‡‘é¢ï¼ˆå«ç¨ï¼‰</div>
      <div class="wallet-balance">RM ${totalTotal.toFixed(2)}</div>
      <div style="display:flex;gap:20px;margin-top:12px;flex-wrap:wrap">
        <div><div style="font-size:.73rem;color:var(--muted)">æœåŠ¡ç¨å‰é‡‘é¢</div><div style="font-family:var(--font-display);color:var(--text)">RM ${totalBase.toFixed(2)}</div></div>
        <div><div style="font-size:.73rem;color:var(--muted)">SST å·²ç¼´</div><div style="font-family:var(--font-display);color:var(--warn)">RM ${totalSST.toFixed(2)}</div></div>
        <div><div style="font-size:.73rem;color:var(--muted)">å¹³å°æœåŠ¡è´¹</div><div style="font-family:var(--font-display);color:var(--muted)">RM ${totalFee.toFixed(2)}</div></div>
      </div>
    </div>
    <div class="card" style="margin-bottom:14px">
      <h3 style="font-family:var(--font-display);font-size:.92rem;margin-bottom:12px">ğŸ“‹ æŠ¥ç¨æç¤º</h3>
      <div class="notice notice-warn" style="margin-bottom:10px">âš ï¸ æœ¬å¹´åº¦å‡€æ”¶å…¥è¶…è¿‡ RM ${totalBase.toFixed(0)}ã€‚è¯·å‚è€ƒä»¥ä¸‹ä¿¡æ¯å®Œæˆ BE Formï¼ˆä¸ªäººæ‰€å¾—ç¨ï¼‰æˆ– B Formï¼ˆæœ‰æ”¶å…¥æ¥æºä¸ªäººï¼‰ç”³æŠ¥ã€‚</div>
      <table class="einv-info-table">
        <tr><td>æŠ¥ç¨å¹´ä»½</td><td>${year}</td></tr>
        <tr><td>å¹³å°æ€»æ”¶å…¥</td><td>RM ${(S.walletTotal).toFixed(2)}</td></tr>
        <tr><td>å·²ç¼´ SST</td><td>RM ${totalSST.toFixed(2)}</td></tr>
        <tr><td>å¹³å°æœåŠ¡è´¹ï¼ˆå¯æŠµæ‰£ï¼‰</td><td>RM ${totalFee.toFixed(2)}</td></tr>
        <tr><td>å‡€åº”ç¨æ”¶å…¥ï¼ˆä¼°ç®—ï¼‰</td><td>RM ${(S.walletTotal-totalFee).toFixed(2)}</td></tr>
        <tr><td>e-Invoice æ•°é‡</td><td>${einvOrders.length} å¼ </td></tr>
        <tr><td>LHDN MyTax ID</td><td>â€”ï¼ˆè¯·åœ¨ MyTax è¾“å…¥æ‚¨çš„ TINï¼‰</td></tr>
      </table>
    </div>
    <div class="notice notice-info" style="margin-bottom:14px">â„¹ï¸ æ‰€æœ‰ e-Invoice è®°å½•å·²åŒæ­¥è‡³ LHDN MyInvois ç³»ç»Ÿï¼Œå¯åœ¨ <a href="https://mytax.hasil.gov.my" target="_blank" style="color:var(--accent)">MyTax Portal</a> ç›´æ¥å¼•ç”¨ã€‚</div>
    <div style="display:flex;gap:8px;flex-wrap:wrap">
      <button class="btn btn-primary btn-sm" onclick="window.print()">ğŸ“„ ä¸‹è½½ PDF æŠ¥å‘Š</button>
      <button class="btn btn-secondary btn-sm" onclick="window.open('https://mytax.hasil.gov.my')">ğŸ›ï¸ MyTax Portal</button>
      <button class="btn btn-secondary btn-sm" onclick="window.open('https://myinvois.hasil.gov.my')">ğŸ§¾ MyInvois Portal</button>
    </div>`;
  openM('taxReportModal');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// WALLET
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderWallet(){
  setText('walletBal','RM '+S.walletBal.toFixed(2));
  setText('wdBal','RM '+S.walletBal.toFixed(2));
  const txl=document.getElementById('txList');
  if(txl)txl.innerHTML=S.earnings.map(t=>`
    <div class="tx-item">
      <div class="tx-icon ${t.dir==='in'?'tx-in':'tx-out'}">${t.dir==='in'?'ğŸ’°':'â†‘'}</div>
      <div class="tx-info"><div class="tx-title">${t.title}</div><div class="tx-meta">${t.meta}</div></div>
      <div class="tx-amount ${t.dir}">${t.dir==='in'?'+':''} RM ${Math.abs(t.amt).toFixed(2)}</div>
    </div>`).join('');
}

function updateWithdrawCalc(){
  const inp=document.getElementById('wdAmt');if(!inp)return;
  const amt=parseFloat(inp.value)||0;
  const fee=amt*0.02;const wht=0;const net=amt-fee-wht;
  setText('wdTaxAmt','RM '+amt.toFixed(2));
  setText('wdTaxFee','RM '+fee.toFixed(2));
  setText('wdTaxWHT','RM '+wht.toFixed(2));
  setText('wdTaxNet','RM '+net.toFixed(2));
}
document.addEventListener('input',e=>{if(e.target.id==='wdAmt')updateWithdrawCalc();});

function doWithdraw(){
  const amt=parseFloat(document.getElementById('wdAmt')?.value)||0;
  if(amt<50){showToast('æœ€ä½ææ¬¾é‡‘é¢ä¸º RM 50','error');return;}
  if(amt>S.walletBal){showToast('ä½™é¢ä¸è¶³','error');return;}
  const acc=document.getElementById('wdAcc')?.value;
  if(!acc){showToast('è¯·å¡«å†™é“¶è¡Œè´¦å·','error');return;}
  S.walletBal-=amt;
  S.earnings.unshift({dir:'out',title:'ææ¬¾è‡³ '+document.getElementById('wdBank').value,meta:new Date().toISOString().split('T')[0]+' Â· è´¦å· ****'+acc.slice(-4),amt:-amt});
  renderWallet();closeM('withdrawModal');
  showToast('ğŸ’¸ ææ¬¾ç”³è¯·å·²æäº¤ï¼Œ1-3ä¸ªå·¥ä½œæ—¥åˆ°è´¦','success');
  setTimeout(()=>showToast('ğŸ“„ ææ¬¾æ‰£ç¨å‡­è¯å·²å‘é€è‡³æ‚¨çš„é‚®ç®±','info'),2000);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CHAT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderChatContacts(){
  const c=document.getElementById('chatContacts');if(!c)return;
  c.innerHTML=Object.keys(CHATS).map(n=>`
    <div class="chat-con${S.currentChat===n?' active':''}" onclick="openChat('${n}')">
      <div class="chat-con-av">${n[0]}<span class="online-dot"></span></div>
      <div style="flex:1;min-width:0">
        <div class="chat-con-name">${n}</div>
        <div class="chat-con-last">${CHATS[n][CHATS[n].length-1].t}</div>
      </div>
      <div class="chat-con-time">åˆšåˆš</div>
    </div>`).join('');
}

function openChat(name){
  S.currentChat=name;if(!CHATS[name])CHATS[name]=[];
  const hd=document.getElementById('chatHd');
  hd.innerHTML=`<div class="chat-con-av" style="width:34px;height:34px;font-size:.85rem">${name[0]}</div><div><div class="chat-hd-name">${name}</div><div class="chat-hd-status">ğŸŸ¢ åœ¨çº¿</div></div><div style="margin-left:auto;display:flex;gap:7px"><button class="btn btn-secondary btn-sm">ğŸ“</button><button class="btn btn-secondary btn-sm">ğŸ“</button></div>`;
  renderMsgs();renderChatContacts();
}

function renderMsgs(){
  const box=document.getElementById('chatMsgs');if(!box||!S.currentChat)return;
  box.innerHTML=(CHATS[S.currentChat]||[]).map(m=>`
    <div class="msg ${m.me?'me':'them'}">
      ${!m.me?`<div class="msg-av">${S.currentChat[0]}</div>`:''}
      <div><div class="msg-bubble">${m.t}</div><div class="msg-time">${m.me?'æ‚¨':'å¯¹æ–¹'} Â· åˆšåˆš</div></div>
    </div>`).join('');
  box.scrollTop=box.scrollHeight;
}

function sendMsg(){
  const inp=document.getElementById('chatInp');if(!inp.value.trim()||!S.currentChat)return;
  if(!CHATS[S.currentChat])CHATS[S.currentChat]=[];
  CHATS[S.currentChat].push({me:true,t:inp.value});inp.value='';renderMsgs();
  setTimeout(()=>{
    const r=['å·²æ”¶åˆ°ï¼Œé©¬ä¸Šå¤„ç†ï¼','å¥½çš„ï¼Œè°¢è°¢æ‚¨çš„æ¶ˆæ¯ã€‚','è¯·ç¨ç­‰ï¼Œæˆ‘ç¡®è®¤åå›å¤æ‚¨ã€‚','æ²¡é—®é¢˜ï¼æˆ‘ä»¬ä¼šå°½å¿«å®Œæˆ âœ…','æ”¶åˆ°ï¼å¦‚æœ‰é—®é¢˜éšæ—¶è”ç³»æˆ‘ ğŸ˜Š'];
    CHATS[S.currentChat].push({me:false,t:r[Math.floor(Math.random()*r.length)]});
    renderMsgs();renderChatContacts();
  },900+Math.random()*1200);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// POST GIG
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let postStep=1;
function goStep(n){
  if(!S.user&&n>1){openM('loginModal');showToast('è¯·å…ˆç™»å½•åå†å‘å¸ƒ Gig','info');return;}
  for(let i=1;i<=4;i++){const el=document.getElementById('postStep'+i);if(el)el.style.display=i===n?'block':'none';}
  document.querySelectorAll('.pg-step').forEach((el,i)=>{el.classList.remove('active','done');if(i+1===n)el.classList.add('active');else if(i+1<n)el.classList.add('done');});
  postStep=n;
  if(n===4)buildPostPreview();
}

function buildPostPreview(){
  const t=document.getElementById('pt')?.value||'æœªå¡«å†™';
  const cat=document.getElementById('pc')?.value||'æœªé€‰æ‹©';
  const p1=document.getElementById('pp1')?.value||0;
  const p2=document.getElementById('pp2')?.value||0;
  const p3=document.getElementById('pp3')?.value||0;
  document.getElementById('postPreview').innerHTML=`
    <div style="display:flex;gap:14px;align-items:center;margin-bottom:14px">
      <div style="font-size:2.5rem">${{game:'ğŸ®',topup:'ğŸ’',code:'ğŸ’»',design:'ğŸ¨',tarot:'ğŸ”®',writing:'ğŸ“',marketing:'ğŸ“£',video:'ğŸ¬'}[cat]||'âœ¨'}</div>
      <div><div style="font-weight:600;margin-bottom:4px">${t}</div><div style="font-size:.78rem;color:var(--muted)">${cat} Â· å–å®¶: ${S.user?S.user.name:'â€”'}</div></div>
    </div>
    <div style="display:flex;gap:12px;flex-wrap:wrap">
      <div style="padding:10px 16px;background:var(--surface2);border-radius:9px;font-size:.8rem"><div style="color:var(--muted)">åŸºç¡€</div><div style="font-family:var(--font-display);color:var(--accent)">RM ${p1}</div></div>
      <div style="padding:10px 16px;background:var(--surface2);border-radius:9px;font-size:.8rem"><div style="color:var(--muted)">æ ‡å‡†</div><div style="font-family:var(--font-display);color:var(--accent2)">RM ${p2}</div></div>
      <div style="padding:10px 16px;background:var(--surface2);border-radius:9px;font-size:.8rem"><div style="color:var(--muted)">é«˜çº§</div><div style="font-family:var(--font-display);color:var(--accent3)">RM ${p3}</div></div>
    </div>`;
}

function updateTaxForm(){
  const v=document.getElementById('sellerTaxType')?.value;
  const sf=document.getElementById('sstFields');
  if(sf)sf.style.display=(v==='sole'||v==='company'||v==='llp')?'block':'none';
}

function submitGig(){
  const t=document.getElementById('pt')?.value;const cat=document.getElementById('pc')?.value;
  if(!t||!cat){showToast('è¯·å¡«å†™ Gig æ ‡é¢˜å’Œåˆ†ç±»','error');return;}
  const p1=parseInt(document.getElementById('pp1')?.value)||50;
  const newGig={id:GIGS.length+1,cat,em:{game:'ğŸ®',topup:'ğŸ’',code:'ğŸ’»',design:'ğŸ¨',tarot:'ğŸ”®',writing:'ğŸ“',marketing:'ğŸ“£',video:'ğŸ¬'}[cat]||'âœ¨',
    title:t,sel:S.user.name,sav:S.user.avatar||S.user.name.substring(0,2).toUpperCase(),lvl:'',
    price:p1,rating:5.0,rev:0,desc:document.getElementById('pd')?.value||'',
    tags:(document.getElementById('ptags')?.value||'').split(',').map(x=>x.trim()).filter(Boolean),
    pkgs:[{n:'åŸºç¡€',p:p1,d:1,r:2,f:['åŸºç¡€æœåŠ¡','æºç äº¤ä»˜']},{n:'æ ‡å‡†',p:parseInt(document.getElementById('pp2')?.value)||120,d:3,r:3,f:['è¿›é˜¶æœåŠ¡','ä¼˜å…ˆæ”¯æŒ']},{n:'é«˜çº§',p:parseInt(document.getElementById('pp3')?.value)||280,d:7,r:'æ— é™',f:['å®Œæ•´æœåŠ¡','ç»´æŠ¤æ”¯æŒ']}]};
  GIGS.unshift(newGig);
  renderGigs('homeGigs',GIGS.slice(0,8));
  renderGigs('newGigs',GIGS.slice(0,4));
  showToast('ğŸš€ Gig å‘å¸ƒæˆåŠŸï¼','success');
  goStep(1);nav('home');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PROFILE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function profTab(el,tab){
  document.querySelectorAll('.prof-tab').forEach(t=>t.classList.remove('active'));
  el.classList.add('active');renderProfContent(tab);
}

function renderProfContent(tab){
  const c=document.getElementById('profContent');if(!c)return;
  if(tab==='overview'){
    c.innerHTML=`
      <div class="card" style="margin-bottom:14px">
        <h3 style="font-family:var(--font-display);font-size:.92rem;margin-bottom:12px">å…³äºæˆ‘</h3>
        <p style="color:var(--muted);font-size:.88rem;line-height:1.7">${S.user?S.user.bio||'ä¸“ä¸šè‡ªç”±èŒä¸šè€…ï¼Œæä¾›ä¼˜è´¨æœåŠ¡ã€‚':'è¯·ç™»å½•æŸ¥çœ‹ã€‚'}</p>
      </div>
      <div class="card">
        <h3 style="font-family:var(--font-display);font-size:.92rem;margin-bottom:12px">è¿‘æœŸè®¢å•</h3>
        ${S.orders.slice(0,3).map(o=>`<div style="display:flex;align-items:center;gap:11px;padding:10px 0;border-bottom:1px solid var(--border)"><span style="font-size:1.5rem">${o.em}</span><div style="flex:1"><div style="font-size:.85rem">${o.gig}</div><div style="font-size:.72rem;color:var(--muted)">${o.pkg}</div></div><span class="status-pill ${o.status==='active'?'sp-active':o.status==='complete'?'sp-complete':'sp-review'}">${{active:'è¿›è¡Œä¸­',review:'å¾…ç¡®è®¤',complete:'å·²å®Œæˆ',dispute:'çº çº·'}[o.status]||'â€”'}</span></div>`).join('')||'<p style="color:var(--muted);font-size:.83rem">æš‚æ— è®¢å•</p>'}
      </div>`;
  }else if(tab==='gigs'){
    const my=GIGS.filter(g=>S.user&&g.sel===S.user.name);
    c.innerHTML=my.length?`<div class="gig-grid">${my.map(g=>`<div class="gig-card" onclick="openGig(${g.id})"><div class="gig-thumb" style="height:120px;background:linear-gradient(135deg,${CAT_GRAD[g.cat]||CAT_GRAD.code})"><span style="font-size:2.5rem;position:relative;z-index:1">${g.em}</span></div><div class="gig-body"><div class="gig-title">${g.title}</div><div class="gig-foot"><div class="g-rating">â˜… ${g.rating}</div><div class="g-price">RM ${g.price}</div></div></div></div>`).join('')}</div>`:
    `<div style="text-align:center;padding:40px;color:var(--muted)"><div style="font-size:2.5rem;margin-bottom:12px">ğŸ›ï¸</div><p>è¿˜æ²¡æœ‰ Gig</p><button class="btn btn-primary" style="margin:16px auto;max-width:180px" onclick="nav('post')">å‘å¸ƒç¬¬ä¸€ä¸ª Gig</button></div>`;
  }else if(tab==='reviews'){
    c.innerHTML=`<div class="card">${buildSampleReviews()}</div>`;
  }else if(tab==='tax'){
    c.innerHTML=`
      <div class="card" style="margin-bottom:14px">
        <h3 style="font-family:var(--font-display);font-size:.92rem;margin-bottom:12px">ğŸ§¾ ç¨åŠ¡æ–‡ä»¶</h3>
        <div class="notice notice-warn" style="margin-bottom:14px">âš ï¸ ä»¥ä¸‹ä¸º NovaServe ä¸ºæ‚¨ç”Ÿæˆçš„ç¨åŠ¡è®°å½•ï¼Œå¯ç”¨äº LHDN å¹´åº¦æŠ¥ç¨ã€‚</div>
        <div style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:14px">
          <button class="btn btn-secondary btn-sm" onclick="openEinvList()">ğŸ§¾ e-Invoice åˆ—è¡¨</button>
          <button class="btn btn-secondary btn-sm" onclick="openTaxReport()">ğŸ“Š å¹´åº¦ç¨åŠ¡æŠ¥å‘Š</button>
          <button class="btn btn-secondary btn-sm" onclick="window.open('https://mytax.hasil.gov.my')">ğŸ›ï¸ MyTax Portal</button>
        </div>
        <table class="einv-info-table">
          <tr><td>e-Invoice æ€»æ•°</td><td>${S.orders.filter(o=>o.einv).length} å¼ </td></tr>
          <tr><td>æ€»äº¤æ˜“é¢</td><td>RM ${S.orders.reduce((s,o)=>s+o.base,0).toFixed(2)}</td></tr>
          <tr><td>å·²ç¼´ SST</td><td>RM ${(S.orders.reduce((s,o)=>s+o.base,0)*0.08).toFixed(2)}</td></tr>
          <tr><td>LHDN TIN</td><td>â€”ï¼ˆåœ¨è®¾ç½®ä¸­å¡«å†™ï¼‰</td></tr>
        </table>
      </div>`;
  }else if(tab==='settings'){
    c.innerHTML=`
      <div class="card">
        <h3 style="font-family:var(--font-display);font-size:.92rem;margin-bottom:18px">è´¦å·è®¾ç½®</h3>
        <div class="form-group"><label class="form-label">LHDN TINï¼ˆç¨åŠ¡è¯†åˆ«å·ï¼‰</label><input class="form-input" placeholder="CXXXXXXXXXXï¼ˆå¯åœ¨ MyTax æŸ¥è¯¢ï¼‰"></div>
        <div class="form-group"><label class="form-label">NRIC / èº«ä»½è¯å·</label><input class="form-input" placeholder="XXXXXX-XX-XXXX"></div>
        <div class="form-group"><label class="form-label">SST æ³¨å†Œå·ï¼ˆå¦‚æœ‰ï¼‰</label><input class="form-input" placeholder="W16-XXXX-XXXXXXXX"></div>
        <hr>
        <div class="form-group"><label class="form-label">é€šçŸ¥åå¥½</label>
          <div style="display:flex;flex-direction:column;gap:8px;margin-top:6px">
            ${['WhatsApp è®¢å•é€šçŸ¥','é‚®ä»¶ e-Invoice','SMS æ”¯ä»˜ç¡®è®¤','æ¨é€é€šçŸ¥ App'].map(item=>`<label style="display:flex;align-items:center;gap:10px;font-size:.85rem;cursor:pointer"><input type="checkbox" checked> ${item}</label>`).join('')}
          </div>
        </div>
        <hr>
        <div class="form-group"><label class="form-label">è¯­è¨€ / Language</label><select class="form-input"><option>ä¸­æ–‡ï¼ˆç®€ä½“ï¼‰</option><option>Bahasa Malaysia</option><option>English</option></select></div>
        <button class="btn btn-primary" style="margin-right:8px" onclick="showToast('è®¾ç½®å·²ä¿å­˜','success')">ä¿å­˜è®¾ç½®</button>
        <button class="btn btn-danger" onclick="logout()">é€€å‡ºç™»å½•</button>
      </div>`;
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// AUTH
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function doLogin(){
  const email=document.getElementById('liEmail')?.value;
  const pass=document.getElementById('liPass')?.value;
  if(!email||!pass){showToast('è¯·å¡«å†™é‚®ç®±å’Œå¯†ç ','error');return;}
  S.user={name:email.split('@')[0],email,avatar:email.substring(0,2).toUpperCase()};
  afterLogin();closeM('loginModal');
}

function doRegister(){
  const name=document.getElementById('rName')?.value;
  const email=document.getElementById('rEmail')?.value;
  const pass=document.getElementById('rPass')?.value;
  if(!name||!email||!pass){showToast('è¯·å¡«å†™å¿…å¡«é¡¹','error');return;}
  if(pass.length<8){showToast('å¯†ç è‡³å°‘ 8 ä½','error');return;}
  S.user={name,email,avatar:name.substring(0,2).toUpperCase(),bio:'NovaServe å¹³å°ç”¨æˆ·'};
  afterLogin();closeM('regModal');showToast('ğŸ‰ æ³¨å†ŒæˆåŠŸï¼æ¬¢è¿åŠ å…¥ NovaServe','success');
}

function socialLogin(p){
  S.user={name:p+'ç”¨æˆ·_'+Math.random().toString(36).substr(2,4),email:'user@'+p.toLowerCase()+'.com',avatar:p.substring(0,2).toUpperCase()};
  closeM('loginModal');afterLogin();
}

function afterLogin(){
  document.getElementById('authBtns').style.display='none';
  document.getElementById('userAvBtn').style.display='flex';
  document.getElementById('userAvBtn').textContent=S.user.avatar;
  document.getElementById('hdrNotif').style.display='flex';
  document.getElementById('hdrCart').style.display='flex';
  document.getElementById('profName').textContent=S.user.name;
  document.getElementById('profMeta').textContent='ä¹°å®¶/å–å®¶ Â· é©¬æ¥è¥¿äºš Â· åŠ å…¥äº 2025';
  document.getElementById('epName').value=S.user.name;
  document.getElementById('statOrders').textContent=S.orders.length;
  document.getElementById('statRating').textContent='4.9â˜…';
  document.getElementById('statGigs').textContent=GIGS.filter(g=>g.sel===S.user.name).length;
  document.getElementById('statEarnings').textContent='RM 1.2K';
  showToast('ğŸ‘‹ æ¬¢è¿å›æ¥ï¼Œ'+S.user.name+'ï¼','success');
}

function selRole(el,role){
  document.querySelectorAll('#regModal .pm-opt').forEach(b=>b.classList.remove('active'));
  el.classList.add('active');S.role=role;
}

function logout(){
  S.user=null;
  document.getElementById('authBtns').style.display='flex';
  document.getElementById('userAvBtn').style.display='none';
  document.getElementById('hdrNotif').style.display='none';
  document.getElementById('hdrCart').style.display='none';
  nav('home');showToast('å·²é€€å‡ºç™»å½•','info');
}

function saveProfEdit(){
  if(S.user){S.user.name=document.getElementById('epName')?.value||S.user.name;S.user.bio=document.getElementById('epBio')?.value;}
  document.getElementById('profName').textContent=S.user?.name||'â€”';
  closeM('editProfModal');showToast('èµ„æ–™å·²æ›´æ–° âœ“','success');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SEARCH & FILTER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function search(){
  const q=(document.getElementById('heroQ')?.value||document.getElementById('hdrQ')?.value||'').toLowerCase();
  const catSel=document.getElementById('heroCat')?.value||'';
  let f=[...GIGS];
  if(q)f=f.filter(g=>g.title.toLowerCase().includes(q)||g.tags.some(t=>t.toLowerCase().includes(q))||g.desc.toLowerCase().includes(q));
  if(catSel&&catSel!=='å…¨éƒ¨åˆ†ç±»'){const catMap={'ğŸ® æ¸¸æˆä»£æ‰“':'game','ğŸ’ æ¸¸æˆä»£å……':'topup','ğŸ’» ç¼–ç¨‹':'code','ğŸ¨ è®¾è®¡':'design','ğŸ”® å åœ':'tarot','ğŸ“ æ–‡æ¡ˆ':'writing'};const c=catMap[catSel];if(c)f=f.filter(g=>g.cat===c);}
  document.getElementById('browseTitle').textContent=q?`æœç´¢ "${q}" â€” ${f.length} ä¸ªç»“æœ`:'å…¨éƒ¨ Gig';
  renderGigs('browseGigs',f);nav('browse');
}

function filterCat(el,cat){
  document.querySelectorAll('.cat-pill').forEach(p=>p.classList.remove('active'));
  el.classList.add('active');
  renderGigs('homeGigs',cat==='all'?GIGS.slice(0,8):GIGS.filter(g=>g.cat===cat));
}

function sortGigs(by){
  let g=[...GIGS];
  if(by==='rating')g.sort((a,b)=>b.rating-a.rating);
  else if(by==='price_low')g.sort((a,b)=>a.price-b.price);
  else if(by==='price_high')g.sort((a,b)=>b.price-a.price);
  renderGigs('browseGigs',g);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// REVIEW
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function setRating(n){
  S.currentRating=n;
  const spans=document.getElementById('starRow')?.querySelectorAll('span');
  const labels=['','å·®è¯„','å°šå¯','è‰¯å¥½','å¾ˆå¥½ï¼','éå¸¸æ»¡æ„ï¼'];
  if(spans)spans.forEach((s,i)=>{s.textContent=i<n?'â˜…':'â˜†';s.style.color=i<n?'var(--gold)':'var(--muted)';});
  setText('ratingLabel',labels[n]||'');
}

function setSub(which,n){
  const el=document.getElementById('subRate'+which);
  if(!el)return;
  el.querySelectorAll('span').forEach((s,i)=>{s.textContent=i<n?'â˜…':'â˜†';s.style.color=i<n?'var(--gold)':'var(--muted)';});
}

function submitReview(){
  if(!S.currentRating){showToast('è¯·å…ˆç»™å‡ºè¯„åˆ†','error');return;}
  closeM('reviewModal');showToast('â­ è¯„ä»·å·²æäº¤ï¼Œæ„Ÿè°¢æ‚¨çš„åé¦ˆï¼','success');
  S.currentRating=0;
}

function submitDispute(){
  closeM('disputeModal');
  const o=S.orders.find(x=>x.status==='active');
  if(o){o.status='dispute';renderOrders(S.orders);}
  showToast('âš–ï¸ çº çº·ç”³è¯·å·²æäº¤ï¼Œå¹³å°å°†åœ¨5ä¸ªå·¥ä½œæ—¥å†…å¤„ç†','warn');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// HELPERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openM(id){document.getElementById(id)?.classList.add('show');}
function closeM(id){document.getElementById(id)?.classList.remove('show');}
function e(ev){return ev.target===ev.currentTarget;}
function setText(id,val){const el=document.getElementById(id);if(el)el.textContent=val;}
function toggleEinvBiz(){const el=document.getElementById('einvBizFields');if(el)el.style.display=el.style.display==='none'?'block':'none';}

function showToast(msg,type='info'){
  const w=document.getElementById('toastWrap');
  const t=document.createElement('div');
  t.className=`toast toast-${type}`;
  const ic={success:'âœ…',error:'âŒ',info:'â„¹ï¸',warn:'âš ï¸'};
  t.innerHTML=`<span>${ic[type]||'â„¹ï¸'}</span>${msg}`;
  w.appendChild(t);
  setTimeout(()=>{t.style.opacity='0';t.style.transform='translateX(100%)';t.style.transition='.3s';setTimeout(()=>t.remove(),300);},3800);
}
</script>
</body>
</html>
